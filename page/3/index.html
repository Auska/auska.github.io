<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="随便写点啥">
<meta property="og:type" content="website">
<meta property="og:title" content="博客">
<meta property="og:url" content="https://auska.github.io/page/3/index.html">
<meta property="og:site_name" content="博客">
<meta property="og:description" content="随便写点啥">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Auska">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://Auska.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-WDMyCloud Gen2(及armv7 CPU机型)教程指南" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/05/01/WDMyCloud%20Gen2(%E5%8F%8Aarmv7%20CPU%E6%9C%BA%E5%9E%8B)%E6%95%99%E7%A8%8B%E6%8C%87%E5%8D%97/" class="article-date">
  <time class="dt-published" datetime="2017-05-01T09:54:12.000Z" itemprop="datePublished">2017-05-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/05/01/WDMyCloud%20Gen2(%E5%8F%8Aarmv7%20CPU%E6%9C%BA%E5%9E%8B)%E6%95%99%E7%A8%8B%E6%8C%87%E5%8D%97/">WDMyCloud Gen2(及armv7 CPU机型)教程指南</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>为了方便更新；以后教程改到博客更新。<br>也欢迎捐助！！！谢谢。</p>
<hr>
<!---more--->

<h1 id="教程更新内容"><a href="#教程更新内容" class="headerlink" title="教程更新内容"></a>教程更新内容</h1><p>此教程仅适用WDMyCloud Gen2（及armv7 CPU机型）：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-01/">WD Gen2应用解锁，安装三方应用教程</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-02/">WDMC 增加机型支持 网页安装迅雷插件，可自启动，重启任务不丢失</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-03/">WDMC 增加机型支持 Aria2插件，网页安装，可自启动，重启任务不丢失。</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-04/">WDMC 增加机型支持 Minidlna插件，网页安装，可自启动，视频共享中心。</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-05/">WDMC 增加机型支持 Transmission插件，网页安装，可自启动，PT下载利器。</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-06/">WDMC 增加机型支持 WordPress插件，网页安装，可自启动，个人博客的好助手。</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-07/">WDMC 多机型支持 PlexMediaServer 给爱看电影的你</a><br><a target="_blank" rel="noopener" href="http://blog.auska.win/2017/05/01/WDMyCloud-08/">WDMyCloud Gen2 安装群晖教程，不会救砖的小白慎入！！！</a></p>
</blockquote>
<h1 id="如何查看CPU类型"><a href="#如何查看CPU类型" class="headerlink" title="如何查看CPU类型"></a>如何查看CPU类型</h1><p>SSH输入：cat &#x2F;proc&#x2F;cpuinfo 查看CPU类型。<br><img src="http://down.nasyun.com/forum/201611/21/113905nxq9axcntcaxr2x7.png" alt="查看CPU类型"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/05/01/WDMyCloud%20Gen2(%E5%8F%8Aarmv7%20CPU%E6%9C%BA%E5%9E%8B)%E6%95%99%E7%A8%8B%E6%8C%87%E5%8D%97/" data-id="cl0xrruay000xc4tybekkhsoj" data-title="WDMyCloud Gen2(及armv7 CPU机型)教程指南" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NAS/" rel="tag">NAS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/WDMyCloud/" rel="tag">WDMyCloud</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-GPG-入门教程" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/29/GPG-%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2017-04-29T11:45:19.000Z" itemprop="datePublished">2017-04-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/29/GPG-%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/">【转载】GPG 入门教程</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>前两篇文章，我介绍了RSA算法。<br>今天，就接着来看，现实中怎么使用这个算法，对信息加密和解密。这要用到GnuPG软件（简称GPG），它是目前最流行、最好用的加密工具之一。</p>
<!---more--->

<hr>
<h1 id="什么是GPG"><a href="#什么是GPG" class="headerlink" title="什么是GPG"></a>什么是GPG</h1><p>要了解什么是GPG，就要先了解PGP。<br>1991年，程序员Phil Zimmermann为了避开政府监视，开发了加密软件PGP。这个软件非常好用，迅速流传开来，成了许多程序员的必备工具。但是，它是商业软件，不能自由使用。所以，自由软件基金会决定，开发一个PGP的替代品，取名为GnuPG。这就是GPG的由来。<br>GPG有许多用途，本文主要介绍文件加密。至于邮件的加密，不同的邮件客户端有不同的设置，请参考Ubuntu网站的介绍。<br>本文的使用环境为Linux命令行。如果掌握了命令行，Windows 或 Mac OS 客户端，就非常容易掌握。GPG并不难学，学会了它，从此就能轻松传递加密信息。建议读者一步步跟着教程做，对每条命令都自行测试。</p>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>GPG有两种安装方式。可以下载源码，自己编译安装。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<p>也可以安装编译好的二进制包。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Debian / Ubuntu 环境</span><br><span class="line">sudo apt-get install gnupg</span><br><span class="line"># Fedora 环境</span><br><span class="line">yum install gnupg</span><br></pre></td></tr></table></figure>
<p>安装完成后，键入下面的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --help</span><br></pre></td></tr></table></figure>
<p>如果屏幕显示GPG的帮助，就表示安装成功。</p>
<h1 id="生成密钥"><a href="#生成密钥" class="headerlink" title="生成密钥"></a>生成密钥</h1><p>安装成功后，使用gen-ken参数生成自己的密钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-key</span><br></pre></td></tr></table></figure>
<p>回车以后，会跳出一大段文字：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gpg (GnuPG) 1.4.12; Copyright (C) 2012 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">请选择您要使用的密钥种类：</span><br><span class="line">　(1) RSA and RSA (default)</span><br><span class="line">　(2) DSA and Elgamal</span><br><span class="line">　(3) DSA (仅用于签名)　</span><br><span class="line">　(4) RSA (仅用于签名)</span><br><span class="line">您的选择？</span><br></pre></td></tr></table></figure>
<p>第一段是版权声明，然后让用户自己选择加密算法。默认选择第一个选项，表示加密和签名都使用RSA算法。<br>然后，系统就会问你密钥的长度。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RSA 密钥长度应在 1024 位与 4096 位之间。</span><br><span class="line">您想要用多大的密钥尺寸？(2048)</span><br></pre></td></tr></table></figure>
<p>密钥越长越安全，默认是2048位。<br>接着，设定密钥的有效期。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">请设定这把密钥的有效期限。</span><br><span class="line">　0 = 密钥永不过期</span><br><span class="line">　&lt;n&gt; = 密钥在 n 天后过期</span><br><span class="line">　&lt;n&gt;w = 密钥在 n 周后过期</span><br><span class="line">　&lt;n&gt;m = 密钥在 n 月后过期</span><br><span class="line">　&lt;n&gt;y = 密钥在 n 年后过期</span><br><span class="line">密钥的有效期限是？(0)</span><br></pre></td></tr></table></figure>
<p>如果密钥只是个人使用，并且你很确定可以有效保管私钥，建议选择第一个选项，即永不过期。回答完上面三个问题以后，系统让你确认。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以上正确吗？(y/n)</span><br></pre></td></tr></table></figure>
<p>输入y，系统就要求你提供个人信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">您需要一个用户标识来辨识您的密钥；本软件会用真实姓名、注释和电子邮件地址组合成用户标识，如下所示：</span><br><span class="line">&quot;Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;&quot;</span><br><span class="line">真实姓名：</span><br><span class="line">电子邮件地址：</span><br><span class="line">注释：</span><br></pre></td></tr></table></figure>
<p>“真实姓名”填入你姓名的英文写法，”电子邮件地址”填入你的邮件地址，”注释”这一栏可以空着。<br>然后，你的”用户ID”生成了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">您选定了这个用户标识：</span><br><span class="line">　&quot;Ruan YiFeng &lt;yifeng.ruan@gmail.com&gt;&quot;</span><br></pre></td></tr></table></figure>
<p>我的”真实姓名”是Ruan YiFeng，”电子邮件地址”是<a href="mailto:&#x79;&#105;&#x66;&#x65;&#110;&#103;&#46;&#x72;&#x75;&#97;&#110;&#64;&#x67;&#109;&#97;&#105;&#108;&#x2e;&#99;&#111;&#109;">&#x79;&#105;&#x66;&#x65;&#110;&#103;&#46;&#x72;&#x75;&#97;&#110;&#64;&#x67;&#109;&#97;&#105;&#108;&#x2e;&#99;&#111;&#109;</a>，所以我的”用户ID”就是”Ruan YiFeng <a href="mailto:&#121;&#105;&#102;&#x65;&#x6e;&#x67;&#46;&#114;&#x75;&#x61;&#110;&#64;&#103;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;">&#121;&#105;&#102;&#x65;&#x6e;&#x67;&#46;&#114;&#x75;&#x61;&#110;&#64;&#103;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;</a>“。系统会让你最后确认一次。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">更改姓名(N)、注释(C)、电子邮件地址(E)或确定(O)/退出(Q)？</span><br></pre></td></tr></table></figure>
<p>输入O表示”确定”。<br>接着，系统会让你设定一个私钥的密码。这是为了防止误操作，或者系统被侵入时有人擅自动用私钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">您需要一个密码来保护您的私钥：</span><br></pre></td></tr></table></figure>
<p>然后，系统就开始生成密钥了，这时会要求你做一些随机的举动，以生成一个随机数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们需要生成大量的随机字节。这个时候您可以多做些琐事(像是敲打键盘、移动鼠标、读写硬盘之类的)，这会让随机数字发生器有更好的机会获得足够的熵数。</span><br></pre></td></tr></table></figure>
<p>几分钟以后，系统提示密钥已经生成了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gpg: 密钥 EDDD6D76 被标记为绝对信任</span><br><span class="line">公钥和私钥已经生成并经签名。</span><br></pre></td></tr></table></figure>
<p>请注意上面的字符串”EDDD6D76”，这是”用户ID”的Hash字符串，可以用来替代”用户ID”。<br>这时，最好再生成一张”撤销证书”，以备以后密钥作废时，可以请求外部的公钥服务器撤销你的公钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-revoke [用户ID]</span><br></pre></td></tr></table></figure>
<p>上面的”用户ID”部分，可以填入你的邮件地址或者Hash字符串（以下同）。</p>
<h1 id="密钥管理"><a href="#密钥管理" class="headerlink" title="密钥管理"></a>密钥管理</h1><h2 id="列出密钥"><a href="#列出密钥" class="headerlink" title="列出密钥"></a>列出密钥</h2><p>list-keys参数列出系统中已有的密钥．</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --list-keys</span><br></pre></td></tr></table></figure>
<p>显示结果如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/home/ruanyf/.gnupg/pubring.gpg</span><br><span class="line">-------------------------------</span><br><span class="line">pub 4096R/EDDD6D76 2013-07-11</span><br><span class="line">uid Ruan YiFeng &lt;yifeng.ruan@gmail.com&gt;</span><br><span class="line">sub 4096R/3FA69BE4 2013-07-11</span><br></pre></td></tr></table></figure>
<p>第一行显示公钥文件名（pubring.gpg），第二行显示公钥特征（4096位，Hash字符串和生成时间），第三行显示”用户ID”，第四行显示私钥特征。<br>如果你要从密钥列表中删除某个密钥，可以使用delete-key参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --delete-key [用户ID]</span><br></pre></td></tr></table></figure>
<h2 id="输出密钥"><a href="#输出密钥" class="headerlink" title="输出密钥"></a>输出密钥</h2><p>公钥文件（.gnupg&#x2F;pubring.gpg）以二进制形式储存，armor参数可以将其转换为ASCII码显示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --armor --output public-key.txt --export [用户ID]</span><br></pre></td></tr></table></figure>
<p>“用户ID”指定哪个用户的公钥，output参数指定输出文件名（public-key.txt）。<br>类似地，export-secret-keys参数可以转换私钥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --armor --output private-key.txt --export-secret-keys</span><br></pre></td></tr></table></figure>
<h2 id="上传公钥"><a href="#上传公钥" class="headerlink" title="上传公钥"></a>上传公钥</h2><p>公钥服务器是网络上专门储存用户公钥的服务器。send-keys参数可以将公钥上传到服务器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --send-keys [用户ID] --keyserver hkp://subkeys.pgp.net</span><br></pre></td></tr></table></figure>
<p>使用上面的命令，你的公钥就被传到了服务器subkeys.pgp.net，然后通过交换机制，所有的公钥服务器最终都会包含你的公钥。<br>由于公钥服务器没有检查机制，任何人都可以用你的名义上传公钥，所以没有办法保证服务器上的公钥的可靠性。通常，你可以在网站上公布一个公钥指纹，让其他人核对下载到的公钥是否为真。fingerprint参数生成公钥指纹。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --fingerprint [用户ID]</span><br></pre></td></tr></table></figure>
<h2 id="输入密钥"><a href="#输入密钥" class="headerlink" title="输入密钥"></a>输入密钥</h2><p>除了生成自己的密钥，还需要将他人的公钥或者你的其他密钥输入系统。这时可以使用import参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --import [密钥文件]</span><br></pre></td></tr></table></figure>
<p>为了获得他人的公钥，可以让对方直接发给你，或者到公钥服务器上寻找。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --keyserver hkp://subkeys.pgp.net --search-keys [用户ID]</span><br></pre></td></tr></table></figure>
<p>正如前面提到的，我们无法保证服务器上的公钥是否可靠，下载后还需要用其他机制验证．</p>
<h1 id="加密和解密"><a href="#加密和解密" class="headerlink" title="加密和解密"></a>加密和解密</h1><h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><p>假定有一个文本文件demo.txt，怎样对它加密呢？<br>encrypt参数用于加密。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --recipient [用户ID] --output demo.en.txt --encrypt demo.txt</span><br></pre></td></tr></table></figure>
<p>recipient参数指定接收者的公钥，output参数指定加密后的文件名，encrypt参数指定源文件。运行上面的命令后，demo.en.txt就是已加密的文件，可以把它发给对方。</p>
<h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p>对方收到加密文件以后，就用自己的私钥解密。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --decrypt demo.en.txt --output demo.de.txt</span><br></pre></td></tr></table></figure>
<p>decrypt参数指定需要解密的文件，output参数指定解密后生成的文件。运行上面的命令，demo.de.txt就是解密后的文件。<br>GPG允许省略decrypt参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg demo.en.txt</span><br></pre></td></tr></table></figure>
<p>运行上面的命令以后，解密后的文件内容直接显示在标准输出。</p>
<h1 id="签名"><a href="#签名" class="headerlink" title="签名"></a>签名</h1><h2 id="对文件签名"><a href="#对文件签名" class="headerlink" title="对文件签名"></a>对文件签名</h2><p>有时，我们不需要加密文件，只需要对文件签名，表示这个文件确实是我本人发出的。sign参数用来签名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --sign demo.txt</span><br></pre></td></tr></table></figure>
<p>运行上面的命令后，当前目录下生成demo.txt.gpg文件，这就是签名后的文件。这个文件默认采用二进制储存，如果想生成ASCII码的签名文件，可以使用clearsign参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --clearsign demo.txt</span><br></pre></td></tr></table></figure>
<p>运行上面的命令后 ，当前目录下生成demo.txt.asc文件，后缀名asc表示该文件是ASCII码形式的。<br>如果想生成单独的签名文件，与文件内容分开存放，可以使用detach-sign参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --detach-sign demo.txt</span><br></pre></td></tr></table></figure>
<p>运行上面的命令后，当前目录下生成一个单独的签名文件demo.txt.sig。该文件是二进制形式的，如果想采用ASCII码形式，要加上armor参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --armor --detach-sign demo.txt</span><br></pre></td></tr></table></figure>
<h2 id="签名-加密"><a href="#签名-加密" class="headerlink" title="签名+加密"></a>签名+加密</h2><p>上一节的参数，都是只签名不加密。如果想同时签名和加密，可以使用下面的命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --local-user [发信者ID] --recipient [接收者ID] --armor --sign --encrypt demo.txt</span><br></pre></td></tr></table></figure>
<p>local-user参数指定用发信者的私钥签名，recipient参数指定用接收者的公钥加密，armor参数表示采用ASCII码形式显示，sign参数表示需要签名，encrypt参数表示指定源文件。</p>
<h2 id="验证签名"><a href="#验证签名" class="headerlink" title="验证签名"></a>验证签名</h2><p>我们收到别人签名后的文件，需要用对方的公钥验证签名是否为真。verify参数用来验证。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --verify demo.txt.asc demo.txt</span><br></pre></td></tr></table></figure>
<p>举例来说，openvpn网站就提供每一个下载包的gpg签名文件。你可以根据它的说明，验证这些下载包是否为真。</p>
<h1 id="转载自"><a href="#转载自" class="headerlink" title="转载自"></a>转载自</h1><p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2013/07/gpg.html">GPG 入门教程</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/29/GPG-%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" data-id="cl0xrruah0005c4tydqo913mx" data-title="【转载】GPG 入门教程" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8A%A0%E5%AF%86/" rel="tag">加密</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%A7%A3%E5%AF%86/" rel="tag">解密</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Bilibili-直播挂机脚本" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/29/Bilibili-%E7%9B%B4%E6%92%AD%E6%8C%82%E6%9C%BA%E8%84%9A%E6%9C%AC/" class="article-date">
  <time class="dt-published" datetime="2017-04-29T04:58:06.000Z" itemprop="datePublished">2017-04-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/29/Bilibili-%E7%9B%B4%E6%92%AD%E6%8C%82%E6%9C%BA%E8%84%9A%E6%9C%AC/">Bilibili 直播挂机脚本</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>PHP 这个最好的语言不拿来写点脚本真是可惜了。</p>
<h2 id="用途"><a href="#用途" class="headerlink" title="用途"></a>用途</h2><p>自动向 Bilibili 服务器发送心跳包，从而实现 24H 挂机涨经验升级。我本人挂机半个月左右，从 Lv1 升级到了 Lv21，虽然等级没什么卵用 :D</p>
<!---more--->

<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><ul>
<li>0.2.0 采用并发机制，支持多账号</li>
<li>0.1.0 初始版本</li>
</ul>
<h2 id="食用方法"><a href="#食用方法" class="headerlink" title="食用方法"></a>食用方法</h2><p>到 <a target="_blank" rel="noopener" href="https://github.com/metowolf/script/tree/master/bilibili">Github</a> 获取最新脚本，上传到服务器或者空间上<code>require &gt;PHP5.4</code>。<br>修改脚本中的 <code>COOKIE</code> 为 <code>live.bilibili.com</code> 站下的 <code>cookie</code> 值。<br>访问该 PHP 脚本路径，<code>http://[yoursite]/onlineHeart.php</code>，查看结果是否正常。<br>设置该脚本 <code>5</code> 分钟运行一次，可以使用 <code>crontab</code> 添加规则，也可以利用监控平台 <code>5</code> 分钟监控一次。<br>正常结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">===============================</span><br><span class="line">name   : 雪狼meto  </span><br><span class="line">level  : 27  </span><br><span class="line">exp    : 3630400/10000000 [36.3%]  </span><br><span class="line">status : OK  </span><br><span class="line">===============================</span><br><span class="line">...</span><br><span class="line">===============================</span><br></pre></td></tr></table></figure>
<p>如果显示 <code>status : @2017-02-26 15:53:01</code> 则表示心跳包过快发送，通常需要间隔 <code>4:52</code> 发送，设置成 <code>5</code> 分钟最为合理了</p>
<h2 id="源码说明"><a href="#源码说明" class="headerlink" title="源码说明"></a>源码说明</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">/**</span><br><span class="line"> *  Author： METO</span><br><span class="line"> *  Version: 0.2.0</span><br><span class="line"> */</span><br><span class="line">class bilibili&#123;  </span><br><span class="line">    public $user=array(</span><br><span class="line">        array(</span><br><span class="line">            &#x27;cookie&#x27; =&gt; &#x27;填写用户cookie&#x27;,</span><br><span class="line">            &#x27;status&#x27; =&gt; 1,</span><br><span class="line">        ),</span><br><span class="line">        array(</span><br><span class="line">            &#x27;cookie&#x27; =&gt; &#x27;第二个用户cookie&#x27;,</span><br><span class="line">            &#x27;status&#x27; =&gt; 0, // 0 表示禁用</span><br><span class="line">        ),</span><br><span class="line">        // 多用户以此类推</span><br><span class="line">    );</span><br><span class="line">    public function display()&#123;</span><br><span class="line">        header(&#x27;Content-Type: text/txt; charset=UTF-8&#x27;);</span><br><span class="line">        echo &quot;===============================\n&quot;;</span><br><span class="line">        foreach($this-&gt;user as $result)&#123;</span><br><span class="line">            if($result[&#x27;status&#x27;])&#123;</span><br><span class="line">                $data=$result[&#x27;data&#x27;];</span><br><span class="line">                $a=$data[&#x27;data&#x27;][&#x27;user_intimacy&#x27;];</span><br><span class="line">                $b=$data[&#x27;data&#x27;][&#x27;user_next_intimacy&#x27;];</span><br><span class="line">                $per=round($a/$b*100,2);</span><br><span class="line">                if(!isset($result[&#x27;cron&#x27;][&#x27;data&#x27;][1]))$msg=&#x27;OK&#x27;;</span><br><span class="line">                else $msg=&#x27;@&#x27;.date(&#x27;Y-m-d H:i:s&#x27;,$result[&#x27;cron&#x27;][&#x27;data&#x27;][1]);</span><br><span class="line"></span><br><span class="line">                echo &quot;name   : &#123;$data[&#x27;data&#x27;][&#x27;uname&#x27;]&#125; \n&quot;;</span><br><span class="line">                echo &quot;level  : &#123;$data[&#x27;data&#x27;][&#x27;user_level&#x27;]&#125; \n&quot;;</span><br><span class="line">                echo &quot;exp    : &#123;$a&#125;/&#123;$b&#125; [&#123;$per&#125;%]\n&quot;;</span><br><span class="line">                echo &quot;status : &#123;$msg&#125;\n&quot;;</span><br><span class="line">                echo &quot;===============================\n&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            else&#123;</span><br><span class="line">                echo &quot;status : &#123;$result[&#x27;data&#x27;][&#x27;msg&#x27;]&#125;\n&quot;;</span><br><span class="line">                echo &quot;===============================\n&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public function cron()&#123;</span><br><span class="line">        $mh=curl_multi_init();</span><br><span class="line">        foreach($this-&gt;user as $id=&gt;$user)&#123;</span><br><span class="line">            if($user[&#x27;status&#x27;]!=1)continue;</span><br><span class="line">            $curl[$id]=$this-&gt;create(&#x27;http://live.bilibili.com/User/userOnlineHeart&#x27;,$user[&#x27;cookie&#x27;]);</span><br><span class="line">            curl_multi_add_handle($mh,$curl[$id]);</span><br><span class="line">        &#125;</span><br><span class="line">        do&#123;</span><br><span class="line">            curl_multi_exec($mh,$running);</span><br><span class="line">            curl_multi_select($mh);</span><br><span class="line">        &#125;while($running&gt;0);</span><br><span class="line">        foreach($curl as $id=&gt;$c)&#123;</span><br><span class="line">            $result[$id]=curl_multi_getcontent($c);</span><br><span class="line">            curl_multi_remove_handle($mh,$c);</span><br><span class="line">        &#125;</span><br><span class="line">        curl_multi_close($mh);</span><br><span class="line">        foreach($result as $id=&gt;$vo)&#123;</span><br><span class="line">            $vo=json_decode($vo,1);</span><br><span class="line">            $this-&gt;user[$id][&#x27;cron&#x27;]=$vo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    public function check()&#123;</span><br><span class="line">        $mh=curl_multi_init();</span><br><span class="line">        foreach($this-&gt;user as $id=&gt;$user)&#123;</span><br><span class="line">            if($user[&#x27;status&#x27;]!=1)continue;</span><br><span class="line">            $curl[$id]=$this-&gt;create(&#x27;http://live.bilibili.com/User/getUserInfo&#x27;,$user[&#x27;cookie&#x27;]);</span><br><span class="line">            curl_multi_add_handle($mh,$curl[$id]);</span><br><span class="line">        &#125;</span><br><span class="line">        do&#123;</span><br><span class="line">            curl_multi_exec($mh,$running);</span><br><span class="line">            curl_multi_select($mh);</span><br><span class="line">        &#125;while($running&gt;0);</span><br><span class="line">        foreach($curl as $id=&gt;$c)&#123;</span><br><span class="line">            $result[$id]=curl_multi_getcontent($c);</span><br><span class="line">            curl_multi_remove_handle($mh,$c);</span><br><span class="line">        &#125;</span><br><span class="line">        curl_multi_close($mh);</span><br><span class="line">        foreach($result as $id=&gt;$vo)&#123;</span><br><span class="line">            $vo=json_decode($vo,1);</span><br><span class="line">            if($vo[&#x27;code&#x27;]&lt;0)$this-&gt;user[$id][&#x27;status&#x27;]=0;</span><br><span class="line">            $this-&gt;user[$id][&#x27;data&#x27;]=$vo;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    private function create($url,$cookie)&#123;</span><br><span class="line">        $curl=curl_init();</span><br><span class="line">        curl_setopt($curl,CURLOPT_URL,$url);</span><br><span class="line">        curl_setopt($curl,CURLOPT_COOKIE,$cookie);</span><br><span class="line">        curl_setopt($curl,CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        curl_setopt($curl,CURLOPT_CONNECTTIMEOUT, 10);</span><br><span class="line">        curl_setopt($curl,CURLOPT_REFERER,&#x27;http://live.bilibili.com/&#x27;);</span><br><span class="line">        curl_setopt($curl,CURLOPT_USERAGENT,&#x27;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/536.5 (KHTML, like Gecko) Chrome/19.0.1084.56 Safari/536.5&#x27;);</span><br><span class="line">        return $curl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$API=new bilibili;</span><br><span class="line">$API-&gt;check();</span><br><span class="line">$API-&gt;cron();</span><br><span class="line">$API-&gt;display();</span><br></pre></td></tr></table></figure>
<p><code>lwl12</code> 的 <code>python</code> 版本实现多了一步获取当前直播间 <code>roomid</code>，我反复试验多次，并不需要这个参数，如果发现无法正常发送心跳包的话欢迎来提 <code>BUG</code></p>
<h2 id="获取-cookie-方法"><a href="#获取-cookie-方法" class="headerlink" title="获取 cookie 方法"></a>获取 cookie 方法</h2><p>~~~ 按 <code>F12</code> 在 <code>console</code> 输入 <code>document.cookie</code> ~~~<br>由于 <code>bilibili</code> 打开了 <code>HttpOnly Cookie</code>，需要在 <code>network</code> 选项卡中找到类似 <code>live_player?optype=&amp;roomid=xxx</code> 的地址，在右侧 <code>Request Header</code> 中复制 <code>cookie</code><br><img src="https://wx2.sinaimg.cn/large/a15b4afegy1fcun6uw37dj20zk0m3aed" alt="示例"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a target="_blank" rel="noopener" href="https://blog.lwl12.com/read/bilibili-live-upgrade.html">Bilibili Live 闷声发大财</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/29/Bilibili-%E7%9B%B4%E6%92%AD%E6%8C%82%E6%9C%BA%E8%84%9A%E6%9C%AC/" data-id="cl0xrruab0001c4tyd0z1g4x1" data-title="Bilibili 直播挂机脚本" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Bilibili/" rel="tag">Bilibili</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8C%82%E6%9C%BA/" rel="tag">挂机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-转载-深入浅出-Git" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/20/%E8%BD%AC%E8%BD%BD-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-Git/" class="article-date">
  <time class="dt-published" datetime="2017-04-20T06:43:50.000Z" itemprop="datePublished">2017-04-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/20/%E8%BD%AC%E8%BD%BD-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-Git/">[转载]深入浅出 Git</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>本文转载自<a target="_blank" rel="noopener" href="https://blog.coding.net/blog/git-from-the-inside-out">Coding</a></p>
<p>这篇文章解释了 Git 是如何工作的。（如果相关内容的谈话更吸引你，你可以观看链接中的<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=fCtZWGhQBvo">视频</a>。）</p>
<!---more--->
<p>本文假设你已经对 Git 理解到了可以对你的项目进行版本控制的程度。本文专注于支撑 Git 的图结构以及这些图的性质影响 Git 行为的方式。通过了解底层，你可以将你心中对 Git 的模型建立在事实之上，而不是基于通过积累使用经验而建立的假设上。这个更真实的模型可以让你更好的理解 Git 做了什么，正在做什么以及将要做什么。</p>
<p>本文由一系列针对单个项目的 Git 命令构成。时不时的，还将有一些对于 Git 所建立的图数据结构的观察。这些观察阐述了图的性质和相应性质所产生的影响。</p>
<p>读完本文后，如果你希望更深入的了解 Git，可以阅读我关于 Git 的 JavaScript 实现<a target="_blank" rel="noopener" href="http://gitlet.maryrosecook.com/docs/gitlet.html">gitlet.js(heavily annotated source code)</a>。</p>
<h3 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~ $ <span class="built_in">mkdir</span> alpha</span><br><span class="line">~ $ <span class="built_in">cd</span> alpha</span><br></pre></td></tr></table></figure>

<p>用户为项目建立一个名为 <code>alpha</code> 的目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">mkdir</span> data</span><br><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;a&#x27;</span> &gt; data/letter.txt</span><br></pre></td></tr></table></figure>

<p>进入目录 <code>alpha</code>，并在下面建立名为 <code>data</code> 的目录。在这个目录中建立一个名为 <code>letter.txt</code> 的文件，其中包含一个字符 <code>a</code>。此时目录结构看起来像这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alpha</span><br><span class="line">└── data</span><br><span class="line">    └── letter.txt</span><br></pre></td></tr></table></figure>


<h3 id="初始化版本库"><a href="#初始化版本库" class="headerlink" title="初始化版本库"></a>初始化版本库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git init</span><br><span class="line">          Initialized empty Git repository</span><br></pre></td></tr></table></figure>

<p><code>git init</code> 命令使得当前目录成为一个 Git 版本库。为此这条命令建立了一个名为的 <code>.git</code> 目录并且向其中写入了一些文件。这些文件定义和记录了关于Git配置和项目历史的所有相关内容。它们只是普通的文件，其中并没有什么类似魔法的神奇之处。用户可以使用文本编辑器和命令行阅读或编辑这些文件。也就是说：用户可以像获取和修改项目文件一样简单地获取和修改项目历史。</p>
<p>这时候目录 <code>alpha</code> 的结构看起来像这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">alpha</span><br><span class="line">├── data</span><br><span class="line">|   └── letter.txt</span><br><span class="line">└── .git</span><br><span class="line">    ├── objects</span><br><span class="line">    etc...</span><br></pre></td></tr></table></figure>


<p><code>.git</code> 目录和其中的内容属于 Git。所有其他的文件一起被称为工作副本，属于用户。</p>
<h3 id="添加一些文件"><a href="#添加一些文件" class="headerlink" title="添加一些文件"></a>添加一些文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git add data/letter.txt</span><br></pre></td></tr></table></figure>

<p>用户对文件 <code>data/letter.txt</code> 运行命令 <code>git add</code>。这一操作产生两个效果。</p>
<p>首先，这一操作在目录 <code>.git/objects/</code> 新建一个BLOB（binary large object 二进制大对象）文件。</p>
<p>这个BLOB文件包含了文件 <code>data/letter.txt</code> 压缩过的内容。文件名由内容的散列值得到。散列一个文本片段，意味着对其内容运行一个程序将其转变为一段更短小[^1]并且唯一地[^2]代表原先文本的文本片段。例如，Git 将 <code>a</code> 散列为 <code>2e65efe2a145dda7ee51d1741299f848e5bf752e</code>。最前面的两个字符被用于对象数据库中目录的命名：<code>.git/objects/2e/</code>。散列值的其余部分被用于包含添加文件内容的BLOB文件的命名：<code>.git/objects/2e/65efe2a145dda7ee51d1741299f848e5bf752e</code>。</p>
<p>注意到将一个文件添加到 Git 中时 Git 是如何将文件的内容保存到 <code>objects</code> 目录中的。即便用户从工作副本中删除文件 <code>data/letter.txt</code> ，它的内容在 Git 库中也是安全的。</p>
<p>其次，<code>git add</code> 命令将文件添加到索引中。索引是一个包含所有 Git 所要跟踪文件的列表。它以文件 <code>.git/index</code> 保存。这个文件每一行建立起一个被跟踪文件与这个文件被添加时散列值的对应关系。这是在 <code>git add</code> 命令被执行之后的索引文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data/letter.txt 2e65efe2a145dda7ee51d1741299f848e5bf752e</span><br></pre></td></tr></table></figure>

<p>用户建立一个叫做 <code>data/number.txt</code> 的文件，内容为  <code>1234</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;1234&#x27;</span> &gt; data/number.txt</span><br></pre></td></tr></table></figure>

<p>工作副本看起来像这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">alpha</span><br><span class="line">└── data</span><br><span class="line">    └── letter.txt</span><br><span class="line">    └── number.txt</span><br></pre></td></tr></table></figure>

<p>用户将这个文件添加到 Git 中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git add data</span><br></pre></td></tr></table></figure>

<p>命令 <code>git add</code> 创建一个包含 <code>data/number.txt</code> 内容的BLOB文件。同时添加一条文件 <code>data/number.txt</code> 的索引项，指向对应的BLOB文件。在 <code>git add</code> 命令第二次被执行之后索引文件如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data/letter.txt 2e65efe2a145dda7ee51d1741299f848e5bf752e</span><br><span class="line">data/number.txt 274c0052dd5408f8ae2bc8440029ff67d79bc5c3</span><br></pre></td></tr></table></figure>

<p>注意到即便用户运行 <code>git add data</code>，也只有 <code>data</code> 目录中的文件在索引文件中被列出。文件夹 <code>data</code> 没有被单独列出。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;1&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data</span><br></pre></td></tr></table></figure>

<p>当用户最初建立 <code>data/number.txt</code> 时，他想要写入 <code>1</code>，而不是 <code>1234</code>。用户做了更改并且将文件添加到索引中。这次的命令创建了一个新的包含了新内容的BLOB文件。并且更新了文件 <code>data/number.txt</code> 的索引项指向新的BLOB文件。</p>
<h3 id="进行一次提交"><a href="#进行一次提交" class="headerlink" title="进行一次提交"></a>进行一次提交</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git commit -m <span class="string">&#x27;a1&#x27;</span></span><br><span class="line">          [master (root-commit) 774b54a] a1</span><br></pre></td></tr></table></figure>

<p>用户做提交  <code>a1</code>。Git 显示出一些有关此次提交的数据。很快我们将看懂这些信息。</p>
<p>提交命令分三步执行。首先，命令建立了一个树图来表示被提交的项目版本的内容。其次，建立一个提交对象。最后，将当前分支指向新的提交对象。</p>
<h4 id="创建一个树图"><a href="#创建一个树图" class="headerlink" title="创建一个树图"></a>创建一个树图</h4><p>Git 通过从索引建立一张树图来记录项目的当前状态。这张树图记录了项目中每一个文件的位置和内容。</p>
<p>图由两种对象组成：BLOB 文件和树。</p>
<p>BLOB 文件由 <code>git add</code> 存储。它们表示了文件的内容。</p>
<p>树是在提交被进行时被存储的。树表示了工作副本中的目录。</p>
<p>下面就是记录新提交中 <code>data</code> 目录内容的树对象：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">100664 blob 2e65efe2a145dda7ee51d1741299f848e5bf752e letter.txt</span><br><span class="line">100664 blob 56a6051ca2b02b04ef92d5150c9ef600403cb1de number.txt</span><br></pre></td></tr></table></figure>

<p>第一行记录了再现 <code>data/letter.txt</code> 文件所需的一切内容。第一部分表明文件权限。第二部分表明此项内容由BLOB文件表示而不是一个树对象。第三个部分表明对应BLOB的散列值。第四部分表明文件名。</p>
<p>第二行记录了关于 <code>data/number.txt</code> 文件的相同内容。</p>
<p>下面是代表 <code>alpha</code> 的树对象，即项目的根目录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">040000 tree 0eed1217a2947f4930583229987d90fe5e8e0b74 data</span><br></pre></td></tr></table></figure>

<p>树中只有一行并指向 <code>data</code> 树。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/6efd8832-4718-4991-894c-ccf2b8033934.png" alt="Tree graph for the `a1` commit"><br><code>a1</code> 提交的树图</p>
<p>在上面的图中，<code>root</code> 树指向 <code>data</code> 树。<code>data</code> 树指向 <code>data/letter.txt</code> 和 <code>data/number.txt</code> 对应的BLOB文件。</p>
<h4 id="创建一个提交对象"><a href="#创建一个提交对象" class="headerlink" title="创建一个提交对象"></a>创建一个提交对象</h4><p><code>git commit</code> 在创建树图之后创建一个提交对象。提交对象是 <code>.git/objects/</code> 目录中另一个文本文件：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tree ffe298c3ce8bb07326f888907996eaa48d266db4</span><br><span class="line">author Mary Rose Cook &lt;mary@maryrosecook.com&gt; 1424798436 -0500</span><br><span class="line">committer Mary Rose Cook &lt;mary@maryrosecook.com&gt; 1424798436 -0500</span><br><span class="line"></span><br><span class="line">a1</span><br></pre></td></tr></table></figure>

<p>第一行指向树图。散列值对应于代表工作副本根目录的树图，这里是 <code>alpha</code> 目录。最后一行是提交信息。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/7d68fb36-f3ee-4758-9fc7-4ac05acddfd6.png" alt="`a1` commit object pointing at its tree graph"><br><code>a1</code> 提交对象指向它的树图</p>
<h4 id="将当前分支指向新提交"><a href="#将当前分支指向新提交" class="headerlink" title="将当前分支指向新提交"></a>将当前分支指向新提交</h4><p>最后，提交命令将当前分支指向新的提交对象。</p>
<p>哪一个分支是当前分支？Git 在 <code>.git/HEAD</code> 目录中的 <code>HEAD</code> 文件中寻找相关信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ref: refs/heads/master</span><br></pre></td></tr></table></figure>

<p>这代表 <code>HEAD</code> 指向 <code>master</code>。<code>master</code> 分支是当前分支。</p>
<p><code>HEAD</code> 和 <code>master</code> 都是引用。引用是 Git 或用户用来标识特定分支的标签。</p>
<p>代表 <code>master</code> 分支的引用并不存在，因为这是版本库的第一次提交。Git 在路径 <code>.git/refs/heads/master</code> 创建文件并且将内容写为提交对象的散列值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">74ac3ad9cde0b265d2b4f1c778b283a6e2ffbafd</span><br></pre></td></tr></table></figure>

<p>（如果你在 Git 中输入你所读到的命令，<code>a1</code> 提交的散列值将与我这里的不同。内容对象例如 BLOB 文件和树总是散列到与本文相同的值上。提交对象并不如此，因为其中包含日期和创建者的名字。）</p>
<p>让我们将 <code>HEAD</code> 和 <code>master</code> 添加到 Git 图中：</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/27f03915-321e-41a2-b92a-b635fcbd9163.png" alt="`master` pointing at the `a1` commit"><br><code>HEAD</code> 指向 <code>master</code> 并且 <code>master</code> 指向 <code>a1</code> 提交</p>
<p><code>HEAD</code> 指向 <code>master</code>，如提交之前一样。但是现在 <code>master</code> 开始存在并且指向新的提交对象。</p>
<h3 id="创建一个非首次提交"><a href="#创建一个非首次提交" class="headerlink" title="创建一个非首次提交"></a>创建一个非首次提交</h3><p>下面是 <code>a1</code> 提交之后的 Git 图。其中包括了工作拷贝和索引。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/09deae62-96aa-428e-b5af-2cf117ec2b53.png" alt="包含工作拷贝和索引的 `a1` 提交"><br>包含工作拷贝和索引的 <code>a1</code> 提交</p>
<p>注意，工作拷贝，索引以及 <code>a1</code> 提交中的 <code>data/letter.txt</code> 和 <code>data/number.txt</code> 文件内容是一样的。索引和 <code>HEAD</code> 提交的散列值都指向的都是 BLOB 对象，但是工作拷贝的内容是作文文本文件存放在不同的地方的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;2&#x27;</span> &gt; data/number.txt</span><br></pre></td></tr></table></figure>

<p>用户将 <code>data/number.txt</code> 的内容设置为 <code>2</code>。该操作更新了工作拷贝，但是没有改变 <code>HEAD</code> 提交以及索引。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/b4e3ea85-a1e8-4123-b4ed-52a4d0b10111.png" alt="工作拷贝中的 `data/number.txt` 设置为 2"><br>工作拷贝中的 <code>data/number.txt</code> 设置为 2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git add data/number.txt</span><br></pre></td></tr></table></figure>

<p>用户将文件添加到 Git。该操作在 <code>object</code> 目录中创建了一个内容为 <code>2</code> 的 BLOB 文件。在新的 BLOB 文件中添加了一条指向 <code>data/number.txt</code> 的索引项。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/6940968e-14ee-48ea-ac52-400a2daddb2e.png" alt="工作拷贝和索引中的 `data/number.txt` 设置为 2"><br>工作拷贝和索引中的 <code>data/number.txt</code> 设置为 2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git commit -m <span class="string">&#x27;a2&#x27;</span></span><br><span class="line">          [master f0af7e6] a2</span><br></pre></td></tr></table></figure>

<p>用户提交。步骤同上。</p>
<p>第一步，创建了一个代表索引内容的树图。</p>
<p><code>data/number</code> 的索引项发生了改变。旧的 <code>data</code> 树不能再反映当前的 <code>data</code> 目录的索引状态。所以必须创建一个一个新的 <code>data</code> 树：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">100664 blob 2e65efe2a145dda7ee51d1741299f848e5bf752e letter.txt</span><br><span class="line">100664 blob d8263ee9860594d2806b0dfd1bfd17528b0ba2a4 number.txt</span><br></pre></td></tr></table></figure>

<p>新的 <code>data</code> 树与旧的 <code>data</code> 树散列值不同。必须创建一个新的 <code>root</code> 树来记录当前散列值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">040000 tree 40b0318811470aaacc577485777d7a6780e51f0b data</span><br></pre></td></tr></table></figure>

<p>第二步，创建一个新的提交对象。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tree ce72afb5ff229a39f6cce47b00d1b0ed60fe3556</span><br><span class="line">parent 774b54a193d6cfdd081e581a007d2e11f784b9fe</span><br><span class="line">author Mary Rose Cook &lt;mary@maryrosecook.com&gt; 1424813101 -0500</span><br><span class="line">committer Mary Rose Cook &lt;mary@maryrosecook.com&gt; 1424813101 -0500</span><br><span class="line"></span><br><span class="line">a2</span><br></pre></td></tr></table></figure>

<p>提交对象的第一行指向了新的 <code>tree</code> 对象。第二行指向 <code>a1</code> 提交：当前提交的父提交。要找到父提交，Git 首先找到头指针 <code>HEAD</code>，然后顺着找到 <code>master</code> 然后获得 <code>a1</code> 提交的散列值。</p>
<p>第三步，将 <code>master</code> 分支文件的内容设置为新提交的散列值。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/52fe0759-8197-4241-806b-c93865dc45e2.png" alt="`a2` 提交"><br><code>a2</code> 提交</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/528d1d9e-9fd9-4ccc-8080-666cf3ddf7ce.png" alt="不包括工作拷贝和索引的 Git 图"><br>不包括工作拷贝和索引的 Git 图</p>
<p><strong>图属性</strong>： 内容被储存为一个树对象。这表明只有差异被储存在对象数据库中。从上图可以看出。<code>a2</code> 提交重复使用了在 <code>a1</code> 提交之前创建的 <code>a</code> BLOB 文件。类似的，如果整个工作目录的内容在一次次提交中没有发生改变，树对象以及所有的 BLOB 文件都能够被重复使用。通常来说，各次提交之间只有很小的改动。这也就意味着 Git 能够使用很小的空间来储存大量的提交历史。</p>
<p><strong>图属性</strong>：每个提交都有一个父提交，也就是说仓库可以储存项目的历史改动。</p>
<p><strong>图属性</strong>：引用（refrences 或者 refs，译者注）是指向一部分提交历史或者其他的条目。也就是说可以给提交取一个有意义的名字。用户将它们的工作组织成单行的固定短语，比如 <code>fix-for-bug-376</code>。Git 使用了一些像 <code>HEAD</code>，<code>MERGE_HEAD</code> 和 <code>FETCH_HEAD</code> 的符号引用来支持一些用来处理提交历史的命令。</p>
<p><strong>图属性</strong>：<code>objects/</code> 目录中的节点都是不可变的。也就是说其中的内容能编辑但是不能删除。你添加到仓库中的所有内容以及你所做的每一个提交都存放在 <code>objects</code> 目录[^3]中的某个地方.</p>
<p><strong>图属性</strong>：引用是可变的。因此，可以改变一个引用的意义。<code>master</code> 所指向的提交可能是当前项目的最好的版本，但是过段时间，它将会被一个更新的或者更好的提交所取代。</p>
<p><strong>图属性</strong>：由引用所指向的工作拷贝以及提交很容易获取，但是获取其他的引用就不那么简单了。也就是说调出最近的提交历史更加容易，但是那也会时常会改变。</p>
<p>工作拷贝是最容易在历史提交中调出的，因为它是仓库的根节点。调出它甚至不需要执行 Git 命令。同时它也是提交历史中的最早的永久节点。用户可以创建一个文件的许多版本，但是如果没有对它们执行 <code>add</code> 操作的话，Git 将不会记录它们。</p>
<p>头指针 <code>HEAD</code> 所指向的提交很容易被调出。它在检出分支的顶端。要查看其中的内容，用户只需执行 stash[^4] 然后检出工作拷贝。同时，<code>HEAD</code> 改变频率最高的引用。</p>
<p>有固定引用指向的提交很容易被调出。用户可以轻易的检出那个分支。分支的顶端通常没有 <code>HEAD</code> 的改变频率高，but often enough for the meaning of a branch name to be changeable.</p>
<p>要调出没有被任何引用所指向的提交很困难。用户在某个引用上提交得越多，操作之前的提交就越不容易。但我们通常很少操作很久之前的提交[^5]。</p>
<h3 id="检出一个提交"><a href="#检出一个提交" class="headerlink" title="检出一个提交"></a>检出一个提交</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout 37888c2</span><br><span class="line">          You are <span class="keyword">in</span> <span class="string">&#x27;detached HEAD&#x27;</span> state...</span><br></pre></td></tr></table></figure>

<p>用户通过对应的散列值来检出 <code>a2</code> 提交。（你过你照搬了以上的 Git 命令，在你的电脑上不会起作用。请使用 <code>git log</code> 命令来查找 <code>a2</code> 提交的散列值。）</p>
<p>检出有以下 4 个步骤。</p>
<p>第一步，Git 获得 <code>a2</code> 提交以及其指向的树图。<br>工作区的内容已经和树图保持一致了，因为我们的HEAD之前就已经通过master指向a2提交了。</p>
<p>第二步，将树图中的文件写入工作拷贝中。这不会产生什么变化。工作拷贝的内容已经和树图中的保持一致了，因为头指针 <code>HEAD</code> 早已经通过 <code>master</code> 指向了 <code>a2</code> 提交。</p>
<p>第三步，Git 将树图中的文件写入索引。同样，这也不会产生什么变化，index 早就有 <code>a2</code> 提交的内容了。</p>
<p>第四步，头指针 <code>HEAD</code> 的内容被设置为 <code>a2</code> 提交的散列值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f0af7e62679e144bb28c627ee3e8f7bdb235eee9</span><br></pre></td></tr></table></figure>

<p>对 <code>HEAD</code> 写入一个散列值会导致仓库进入头指针分离状态。注意下图中的 <code>HEAD</code> 直接指向了 <code>a2</code> 提交，而不是指向 <code>master</code>。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/dfee80a2-f92b-48e8-a457-50d7e1e910b9.png" alt="分离头指针到 `a2` 提交"><br>分离头指针到 <code>a2</code> 提交</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;3&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;a3&#x27;</span></span><br><span class="line">          [detached HEAD 3645a0e] a3</span><br></pre></td></tr></table></figure>

<p>用户将 <code>data/number.txt</code> 的值设置为 <code>3</code> 然后提交更改。Git 找到 <code>HEAD</code> 然后找到 <code>a3</code> 提交的父提交。这回返回 <code>a2</code> 提交的散列值而不是查找一个分支引用。</p>
<p>Git 将 <code>HEAD</code> 更新，使其直接指向 <code>a3</code> 提交的哈希值。此时仓库仍然处于头指针分离状态，而没有在一个分支上，因为没有引用指向 <code>a3</code> 提交亦或是它之后的提交。这意味着它很容易丢失。</p>
<p>从现在起，图示中大多的树和 BLOB 都会省略。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/ce4fb585-537b-4a50-baf5-e4edc4fea7fc.png" alt="没有在分支上的 `a3` 提交"><br>没有在分支上的 <code>a3</code> 提交</p>
<h3 id="创建一个分支"><a href="#创建一个分支" class="headerlink" title="创建一个分支"></a>创建一个分支</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git branch deputy</span><br></pre></td></tr></table></figure>

<p>用户创建了一个新的叫做 <code>deputy</code> 的分支。这个操作在 <code>.git/refs/heads/deputy</code> 目录下创建了新文件，其包含了 <code>HEAD</code> 指向的散列值：<code>a3</code> 提交的散列值。</p>
<p><strong>图属性</strong>：分支其实就是引用，而引用其实就是文件。这也就是说 Git 的分支是很轻量的。</p>
<p>创建 <code>deputy</code> 分支的操作实际上将新的 <code>a3</code> 提交安全地放在了一个新的分支上。<code>HEAD</code> 指针目前仍处于分离状态，因为它现在仍是直接指向了一个提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/cd28055d-823d-4774-acaa-e0226c25b748.png" alt="处于 `deputy` 分支的 `a3` 提交"><br>处于 <code>deputy</code> 分支的 <code>a3</code> 提交</p>
<h3 id="检出分支"><a href="#检出分支" class="headerlink" title="检出分支"></a>检出分支</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout master</span><br><span class="line">          Switched to branch <span class="string">&#x27;master&#x27;</span></span><br><span class="line">		  ---</span><br><span class="line">          检出<span class="string">&#x27;master&#x27;</span>分支</span><br></pre></td></tr></table></figure>

<p>用户检出了’master’分支</p>
<p>首先, Git 找到’master’分支所指向的<code>a2</code>提交对象并获取该提交对象所指向的树对象.</p>
<p>接下来 Git 会将树对象储存的文件写到当前工作副本中, 该操作将覆写<code>data/number.txt</code>为<code>2</code>.</p>
<p>第三步, Git 将树对象中的文件入口写入 index, <code>data/number.txt</code>的文件入口将会被更新为<code>2</code> blob 的 hash 值</p>
<p>最后 Git 通过将<code>HEAD</code>中的 hash 值替换为如下内容来使<code>HEAD</code>指向<code>master</code>分支:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ref: refs/heads/master</span><br></pre></td></tr></table></figure>

<p><img src="https://dn-coding-net-production-pp.qbox.me/811ef648-b184-4fb2-8aca-566fc4b5d88f.png" alt="`master`分支被检出, 指向&#39;a2&#39;提交"><br><code>master</code>分支被检出, 指向’a2’提交</p>
<h3 id="检出与当前工作副本相冲突的分支"><a href="#检出与当前工作副本相冲突的分支" class="headerlink" title="检出与当前工作副本相冲突的分支"></a>检出与当前工作副本相冲突的分支</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;789&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git checkout deputy</span><br><span class="line">          Your changes to these files would be overwritten</span><br><span class="line">          by checkout:</span><br><span class="line">            data/number.txt</span><br><span class="line">          Commit your changes or stash them before you</span><br><span class="line">          switch branches.</span><br><span class="line">          ---</span><br><span class="line">	      对以下文件做出的更改将在检出中被覆盖:</span><br><span class="line">		      data/number.txt</span><br><span class="line">		  请在检出前将这些更改提交或储藏.</span><br></pre></td></tr></table></figure>

<p>用户无意中将<code>data/number.txt</code>的内容更改为<code>789</code>, 此时他尝试检出<code>deputy</code>分支, Git 没有执行这次检出.</p>
<p>当前<code>HEAD</code>指向 <code>master</code>分支, 其所指向提交<code>a2</code>中<code>data/number.txt</code>的内容为<code>2</code>. <code>deputy</code>分支指向的提交<code>a3</code>中<code>data/number.txt</code>的内容为<code>3</code>. 当前工作副本中<code>data/number.txt</code>的内容为<code>789</code>. 这个文件的各个版本各不相同, 必须通过一种方法来消除这些差异.</p>
<p>如果 Git 将当前版本的<code>data/number.txt</code>替换成将要检出的分支中的版本则会造成数据遗失, Git 不允许这种情况发生.</p>
<p>如果 Git 将要检出的分支与当前工作副本合并则会导致冲突</p>
<p>因此 Git 中断了此次检出.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;2&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git checkout deputy</span><br><span class="line">          Switched to branch <span class="string">&#x27;deputy&#x27;</span></span><br></pre></td></tr></table></figure>

<p>用户注意到了对<code>data/number.txt</code>的意外操作, 在把它的内容修改回<code>2</code>后成功检出了<code>deputy</code>分支.</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/8ce57f10-b904-499d-8d52-8a7c62c67665.png" alt="`deputy` 分支被检出"><br><code>deputy</code> 分支被检出</p>
<h3 id="合并一个祖先分支"><a href="#合并一个祖先分支" class="headerlink" title="合并一个祖先分支"></a>合并一个祖先分支</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git merge master</span><br><span class="line">          Already up-to-date.</span><br></pre></td></tr></table></figure>

<p>用户将<code>master</code>分支合并到<code>deputy</code>中. 合并两个分支其本质为合并两个提交对象. 其一－作为接受者(receiver)－是<code>deputy</code>所指向的提交对象, 其二－作为给予者(giver)－是<code>master</code>所指向的提交对象. 在这次合并中 Git 不会执行任何操作, 而仅仅打印出<code>Already up-to-date.</code>.</p>
<p><strong>[图属性]</strong>: 图示中的一系列提交对象可以被认为是对仓库内容进行的一些列更改. 因此在一次合并当中, 若想要并入的分支是当前分支的祖先分支, Git不会执行任何操作, 因为想要并入分支中的改动已经被包含在了当前分支中.</p>
<h3 id="合并后代提交"><a href="#合并后代提交" class="headerlink" title="合并后代提交"></a>合并后代提交</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout master</span><br><span class="line">          Switched to branch <span class="string">&#x27;master&#x27;</span></span><br></pre></td></tr></table></figure>

<p>用户检出了 <code>master</code> 分支.</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/ee137c5c-9d93-4728-8c97-fc97bb92b68b.png" alt="`master` checked out and pointing at the `a2` commit"><br><code>master</code> 被检出并指向了 <code>a2</code> 提交</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git merge deputy</span><br><span class="line">          Fast-forward</span><br></pre></td></tr></table></figure>

<p>他们合并 <code>deputy</code> 分支到 <code>master</code>。Git 发现赠予提交的 <code>a2</code> 是源提交 <code>a3</code> 的祖先提交。这里可以执行 fast-forward 合并。</p>
<p>Git 获取赠予提交和它指向的树图，将树图中的文件写入工作区和 index。这将 <code>master</code> 分支 <code>fast-forward</code> 到了 <code>a3</code> 提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/01295a6a-4605-4d2f-8e42-1fbf83b4cd86.png" alt="`a3` commit from `deputy` fast-forward merged into `master`"><br><code>deputy</code> 分支的 <code>a3</code> 提交 fast-forward 合并到了 <code>master</code> 分支</p>
<p><strong>图属性</strong>：图中的提交系列被视为对仓库内容的一系列更改。这意味着，如果赠予提交是接收提交的后代提交，提交历史不会变。已经存在一序列提交来描述赠予提交和接收提交之间的变化。但是尽管 Git 历史不变，Git 的状态图是会改变的。<code>HEAD</code> 指向的具体引用会更新以指向赠予提交。</p>
<h3 id="合并不同提交线的两个提交"><a href="#合并不同提交线的两个提交" class="headerlink" title="合并不同提交线的两个提交"></a>合并不同提交线的两个提交</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;4&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;a4&#x27;</span></span><br><span class="line">          [master 7b7bd9a] a4</span><br></pre></td></tr></table></figure>

<p>用户将文件  <code>number.txt</code>  的内容改为 <code>4</code>  然后提交到  <code>master</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout deputy</span><br><span class="line">          Switched to branch <span class="string">&#x27;deputy&#x27;</span></span><br><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;b&#x27;</span> &gt; data/letter.txt</span><br><span class="line">~/alpha $ git add data/letter.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;b3&#x27;</span></span><br><span class="line">          [deputy 982dffb] b3</span><br></pre></td></tr></table></figure>

<p>用户检出  <code>deputy</code> 分支，将文件  <code>data/letter.txt</code>  内容改为  <code>b</code> 然后提交到  <code>deputy</code> 分支。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/80719b96-0028-4998-810e-cb5ab96c3f12.png" alt="`a4` committed to `master`, `b3` committed to `deputy` and `deputy` checked out"><br><code>a4</code> 提交到 <code>master</code>, <code>b3</code> 提交到 <code>deputy</code> ， <code>deputy</code> 被检出</p>
<p><strong>图属性</strong>: 多个提交可以共用一个父提交，这意味着新提交线可以在提交历史里创建出来。</p>
<p><strong>图属性</strong>: 某提交可以有多个父提交，这意味着两个不同的提交线可以被一个合并提交来合并。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git merge master -m <span class="string">&#x27;b4&#x27;</span></span><br><span class="line">          Merge made by the <span class="string">&#x27;recursive&#x27;</span> strategy.</span><br></pre></td></tr></table></figure>

<p>用户合并 <code>master</code> 到 <code>deputy</code>.</p>
<p>Git 发现接收提交 <code>b3</code>和赠予提交 <code>a4</code>在不同的提交线上。它创建了一个合并提交。这个过程总共分八步。</p>
<p>第一步，Git 将接收提交的哈希值写入文件 <code>alpha/.git/MERGE_HEAD</code>。此文件的存在说明 Git 正在做合并操作。</p>
<p>第二步，Git 查找基提交：即接收提交和赠予提交共有的一个最近父提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/4eb43dad-cf0c-4281-8e4c-e9e1b7a797da.png" alt="`a3`, the base commit of `a4` and `b3`"><br><code>a3</code> 是  <code>a4</code>  和  <code>b3</code> 的基提交</p>
<p>图属性：每个提交都有一个父提交。这意味着我们可以发现两个提交线分开自哪个提交。Git 查找 <code>b3</code> 和 <code>a4</code> 的所有祖先提交，发现了最近的公共父提交 <code>a3</code>，即为他们的基提交。</p>
<p>第三步，Git 为基提交、接收提交和赠予提交创建索引。</p>
<p>第四步，Git 产生接收提交和赠予提交相对于基提交的 diff，此处的 diff 是一个文件路径列表，指向一个变化：包括添加、移除、修改或冲突。</p>
<p>Git 获取基提交、接收提交和赠予提交的文件列表，针对每一个文件，通过对比 index 来判断它的状态与写入变更。它将对应条目写入 diff。在这个例子中，diff 包含两个条目。</p>
<p>第一项记录 <code>data/letter.txt</code> 的状态。该文件内容分别是基提交中的  <code>a</code> 、接收提交中的<code>b</code>和赠予提交中的<code>a</code>。文件内容在基提交和接收提交不同，但在基提交和赠予提交相同。Git 发现文件内容被接收提交修改了，而不是在赠予提交中。<code>data/letter.txt</code> 的状态是修改，而不是冲突。</p>
<p>第二项记录 <code>data/number.txt</code> 的变更。在这个例子中，该文件内容在基提交和接收提交中是相同的，但在基提交和赠予提交是不同的。 <code>data/number.txt</code> 条目的状态也是修改。</p>
<p><strong>图属性</strong>：查找一个合并操作的基提交是可行的。这意味着，如果基提交中的一个文件只在接收提交或赠予提交做了修改，Git 可以自动除了合并文件，这样就减少了用户的工作量。</p>
<p>第五步，Git 将差异中的项被应用到工作区。<code>data/letter.txt</code> 内容被修改为<code>b</code>，<code>data/number.txt</code> 内容被修改为 <code>4</code>。</p>
<p>第六步，Git 将差异中的项应用到 index。<code>data/letter.txt</code> 会指向内容为 <code>b</code> 的 blob，<code>data/number.txt</code> 会指向内容为 <code>4</code> 的 blob。</p>
<p>第七步，更新后的 index 被提交：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tree 20294508aea3fb6f05fcc49adaecc2e6d60f7e7d</span><br><span class="line">parent 982dffb20f8d6a25a8554cc8d765fb9f3ff1333b</span><br><span class="line">parent 7b7bd9a5253f47360d5787095afc5ba56591bfe7</span><br><span class="line">author Mary Rose Cook &lt;mary@maryrosecook.com&gt; 1425596551 -0500</span><br><span class="line">committer Mary Rose Cook &lt;mary@maryrosecook.com&gt; 1425596551 -0500</span><br><span class="line"></span><br><span class="line">b4</span><br></pre></td></tr></table></figure>

<p>注意，这个提交有两个父提交。</p>
<p>第八步，Git 将当前分支 <code>deputy</code> 指向新提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/d0fed804-09e8-4783-a54e-a90dfc2a0af5.png" alt="`b4`, the merge commit resulting from the recursive merge of `a4` into `b3`"><br> <code>a4</code>递归合并入 <code>b3</code> 产生 <code>b4</code></p>
<h3 id="合并不同提交线且有相同修改文件的两个提交"><a href="#合并不同提交线且有相同修改文件的两个提交" class="headerlink" title="合并不同提交线且有相同修改文件的两个提交"></a>合并不同提交线且有相同修改文件的两个提交</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout master</span><br><span class="line">          Switched to branch <span class="string">&#x27;master&#x27;</span></span><br><span class="line">~/alpha $ git merge deputy</span><br><span class="line">          Fast-forward</span><br></pre></td></tr></table></figure>

<p>用户检出 <code>master</code>，他们将 <code>deputy</code> 合并到 <code>master</code>。此操作将<code>master</code> fast-forwards 指向 <code>b4</code>。<code>master</code> 和 <code>deputy</code> 现指向了相同的提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/5465bf93-07a3-46bf-8adb-85f562ed1cc5.png" alt="`deputy` merged into `master` to bring `master` up to the latest commit, `b4`"><br><code>deputy</code> 合并到 <code>master</code> 将 <code>master</code> 更新到新提交 <code>b4</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout deputy</span><br><span class="line">          Switched to branch <span class="string">&#x27;deputy&#x27;</span></span><br><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;5&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;b5&#x27;</span></span><br><span class="line">          [deputy bd797c2] b5</span><br></pre></td></tr></table></figure>

<p>用户检出 <code>deputy</code>。将 <code>data/number.txt</code> 内容修改为 <code>5</code>并提交到 <code>deputy</code>  分支。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git checkout master</span><br><span class="line">          Switched to branch <span class="string">&#x27;master&#x27;</span></span><br><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;6&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;b6&#x27;</span></span><br><span class="line">          [master 4c3ce18] b6</span><br></pre></td></tr></table></figure>

<p>用户检出 <code>master</code>。将 <code>data/number.txt</code> 内容修改为 <code>6</code> 并提交到 <code>master</code> 分支。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/eefd5217-39cd-4847-89f0-029cdde0d2fc.png" alt="`b5` commit on `deputy` and `b6` commit on `master`"><br><code>b5</code> 提交在 <code>deputy</code>   <code>b6</code> 提交在 <code>master</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git merge deputy</span><br><span class="line">          CONFLICT <span class="keyword">in</span> data/number.txt</span><br><span class="line">          Automatic merge failed; fix conflicts and</span><br><span class="line">          commit the result.</span><br></pre></td></tr></table></figure>

<p>用户将 <code>deputy</code> 合并到 <code>master</code>。这里存在冲突故合并中止。对于有冲突的合并操作，执行步骤和没有冲突的合并的前六步是相同的：设置 <code>.git/MERGE_HEAD</code>，查找基提交，创建基提交、接收提交和赠予提交的索引，生成 diff，更新工作区，更新 index。由于冲突，第七步提交和第八步更新 ref 不再执行。让我们再来看看这些步骤，观察到底发生了什么。</p>
<p>第一步，Git 将赠予提交的哈希值写入 <code>.git/MERGE_HEAD</code>.</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/3d00a7b8-b5a7-4afc-8d57-e464ab4abab7.png" alt="`MERGE_HEAD` written during merge of `b5` into `b6`"><br><code>MERGE_HEAD</code> 写入在 <code>b5</code> 合并入 <code>b6</code></p>
<p>第二步，Git 查找到基提交, <code>b4</code>.</p>
<p>第三步，Git 创建基提交、接收提交和赠予提交的索引。</p>
<p>第四步，Git 生成集合了接收提交和赠予提交相对于基提交的差异列表，这个 diff 是一份指向变更的文件路径：添加、删除、修改或冲突。</p>
<p>在本例中，差异列表仅包含一项： <code>data/number.txt</code>。它的状态被标为冲突因为其内容在接收提交，赠予提交和基提交中都是变化的。</p>
<p>第五步，差异列表中的文件被写入工作区。对于冲突的部分，Git 将两个版本都写入工作区的文件中。<code>data/number.txt</code>  的内容被变更为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span><br><span class="line">6</span><br><span class="line">=======</span><br><span class="line">5</span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;&gt; deputy</span><br></pre></td></tr></table></figure>

<p>第六步，差异列表中的文件被写入 index。index 中的项被文件路径和 stage 的组合唯一标识。没有冲突的项 stage 为 <code>0</code>。在该合并前，index 看起来像下面的样子，标有 <code>0</code> 的是 stage 值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 data/letter.txt 63d8dbd40c23542e740659a7168a0ce3138ea748</span><br><span class="line">0 data/number.txt 62f9457511f879886bb7728c986fe10b0ece6bcb</span><br></pre></td></tr></table></figure>

<p>在合并 diff 写入 index 后，index 变成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0 data/letter.txt 63d8dbd40c23542e740659a7168a0ce3138ea748</span><br><span class="line">1 data/number.txt bf0d87ab1b2b0ec1a11a3973d2845b42413d9767</span><br><span class="line">2 data/number.txt 62f9457511f879886bb7728c986fe10b0ece6bcb</span><br><span class="line">3 data/number.txt 7813681f5b41c028345ca62a2be376bae70b7f61</span><br></pre></td></tr></table></figure>

<p>stage <code>0</code> 的 <code>data/letter.txt</code> 项和合并前是一样的。stage <code>0</code> 的 <code>data/number.txt</code> 项已经不存在，取代的是三个新项。stage <code>1</code> 的项包含该文件在基提交中内容的哈希值，stage <code>2</code> 包含接收提交的哈希值，stage <code>3</code>包含赠予提交的哈希值。这三项表明文件 <code>data/number.txt</code> 存在冲突。</p>
<p>合并中止了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;11&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br></pre></td></tr></table></figure>

<p>用户通过将 <code>data/number.txt</code> 的内容修改为 <code>11</code>将两个有冲突的文件合并，将文件添加到 index，Git 创建一个包含<code>11</code> 的 blob，创建一个冲突文件以告诉 Git 冲突已经解决了。Git 移除 index 中的 <code>1</code>, <code>2</code> 和 <code>3</code>，并添加 stage 为 <code>0</code> 的 <code>data/number.txt</code> 项，该项指向新创建 blob 的哈希值。现在 index 变为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 data/letter.txt 63d8dbd40c23542e740659a7168a0ce3138ea748</span><br><span class="line">0 data/number.txt 9d607966b721abde8931ddd052181fae905db503</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git commit -m <span class="string">&#x27;b11&#x27;</span></span><br><span class="line">          [master 251a513] b11</span><br></pre></td></tr></table></figure>

<p>第七步，用户进行提交。Git 发现存在 <code>.git/MERGE_HEAD</code>，意味着合并还在进行中。通过检查 index 发现没有冲突。它创建了一个新提交 <code>b11</code>，用来记录合并后的内容。然后删除 <code>.git/MERGE_HEAD</code>。合并完成。</p>
<p>第八步，Git 将当前分支 master 指向新提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/143f5225-385c-4d0a-bbaa-210d1a133dd5.png" alt="`b11`, the merge commit resulting from the conflicted, recursive merge of `b5` into `b6`"><br> <code>b5</code> 和 <code>b6</code>递归合并为<code>b11</code>  </p>
<h3 id="删除文件"><a href="#删除文件" class="headerlink" title="删除文件"></a>删除文件</h3><p>这幅 Git 示意图包含对于最后一次提交的历史提交、树对象、储存对象、工作副本以及索引。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/dde3e6e1-5cc4-427a-a70f-bca0da91588b.png" alt="The working copy, index, `b11` commit and its tree graph"><br>工作副本、索引， <code>b11</code> 提交以及它的树对象。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git <span class="built_in">rm</span> data/letter.txt</span><br><span class="line">          <span class="built_in">rm</span> <span class="string">&#x27;data/letter.txt&#x27;</span></span><br></pre></td></tr></table></figure>

<p>该用户告诉 Git 删除 <code>data/letter.txt</code>。 文件将从工作副本中删除，该文件的入口也将从索引中消失。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/6d9794f4-8374-4092-b1a8-a7bc88efe95b.png" alt="After `data/letter.txt` `rm`ed from working copy and index"><br>After <code>data/letter.txt</code> <code>rm</code>ed from working copy and index<br> <code>data/letter.txt</code> 从工作副本以及索引中 <code>rm</code> 过后</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git commit -m <span class="string">&#x27;11&#x27;</span></span><br><span class="line">          [master d14c7d2] 11</span><br></pre></td></tr></table></figure>

<p>该用户进行提交了。 一般说来，Git 会在提交时构建一张树图代表索引内容，<code>data/letter.txt</code> 并不会出现在树中，因为它不在索引里。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/ecc82701-37fd-4509-b300-7e9199d7a511.png" alt="`11` commit made after `data/letter.txt` `rm`ed"><br><code>data/letter.txt</code> 删除后进行 <code>11</code> 提交</p>
<h3 id="复制一个库"><a href="#复制一个库" class="headerlink" title="复制一个库"></a>复制一个库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">cd</span> ..</span><br><span class="line">      ~ $ <span class="built_in">cp</span> -R alpha bravo</span><br></pre></td></tr></table></figure>

<p>用户复制 <code>alpha/</code> 库中的内容到 <code>bravo/</code> 目录中，使得目录结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~</span><br><span class="line">├── alpha</span><br><span class="line">|   └── data</span><br><span class="line">|       └── number.txt</span><br><span class="line">└── bravo</span><br><span class="line">    └── data</span><br><span class="line">        └── number.txt</span><br></pre></td></tr></table></figure>

<p><code>bravo</code> 目录即生成另一张 Git 图：</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/43030a5c-7727-4be4-a406-07bbb392256c.png" alt="New graph created when `alpha` `cp`ed to `bravo`"><br>当 <code>alpha</code> <code>cp</code> 至 <code>bravo</code> 后产生的新图</p>
<h3 id="链接至另一个库"><a href="#链接至另一个库" class="headerlink" title="链接至另一个库"></a>链接至另一个库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">      ~ $ <span class="built_in">cd</span> alpha</span><br><span class="line">~/alpha $ git remote add bravo ../bravo</span><br></pre></td></tr></table></figure>

<p>用户回到 <code>alpha</code> 库中，设置 <code>bravo</code> 为一个 <code>alpha</code> 的远程库，这会使 <code>alpha/.git/config</code> 多了这几行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[remote &quot;bravo&quot;]</span><br><span class="line">	url = ../bravo/</span><br></pre></td></tr></table></figure>

<p>这几行说明有个叫 <code>bravo</code> 的远程库在 <code>../bravo</code> 中。</p>
<h3 id="获取远程分支"><a href="#获取远程分支" class="headerlink" title="获取远程分支"></a>获取远程分支</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">cd</span> ../bravo</span><br><span class="line">~/bravo $ <span class="built_in">printf</span> <span class="string">&#x27;12&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/bravo $ git add data/number.txt</span><br><span class="line">~/bravo $ git commit -m <span class="string">&#x27;12&#x27;</span></span><br><span class="line">          [master 94cd04d] 12</span><br></pre></td></tr></table></figure>

<p>进入 <code>bravo</code> 目录. 覆写 文件 <code>data/number.txt</code> 为 <code>12</code> ，将改动提交到<code>bravo</code>仓库的分支 <code>master</code>.</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/148d51fe-fc62-4d70-901c-dbafe2d3d9f1.png" alt="`12` commit on `bravo` repository"></p>
<p><code>bravo</code> 仓库中的一个提交<code>12</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/bravo $ <span class="built_in">cd</span> ../alpha</span><br><span class="line">~/alpha $ git fetch bravo master</span><br><span class="line">          Unpacking objects: 100%</span><br><span class="line">          From ../bravo</span><br><span class="line">            * branch master -&gt; FETCH_HEAD</span><br></pre></td></tr></table></figure>

<p>进入 <code>alpha</code> 目录，从 <code>bravo </code>仓库获取 <code>master </code>分支到 <code>alpha</code> 仓库到 <code>master</code> 分支。这个过程包含了四个步骤。</p>
<p>第一步，Git 获取 <code>bravo </code>仓库中 <code>master</code> 分支所指向提交的 hash 值，即 提交 <code>12</code> 所对应的 hash 值。</p>
<p>第二步，Git 会给做出 <code>12</code> 这个提交依赖的所有对象组成的一个列表：包含了提交对象自身，树图中的对象，提交 <code>12</code> 所对应的父提交，父提交树图对象。然后从列表中移除所有在 alpha 仓库对象数据库中已有的对象。复制剩下的对象到目录 <code>alpha/.git/objects/</code>。</p>
<p>第三步，将 <code>12</code>这个提交的 hash 值 写入文件 <code>alpha/.git/refs/remotes/bravo/master</code> 。</p>
<p>第四步，文件 <code>alpha/.git/FETCH_HEAD</code> 内容被置为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">94cd04d93ae88a1f53a4646532b1e8cdfbc0977f branch &#x27;master&#x27; of ../bravo</span><br></pre></td></tr></table></figure>

<p>文件内容表明从 <code>bravo</code> 仓库 <code>master</code> 分支获取了 <code>12</code> 这个提交。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/e602667a-1277-4e27-ac0d-34c8b2ae00f6.png" alt="`alpha` after `bravo/master` fetched"></p>
<p>从 <code>bravo/master</code> 获取后的<code>alpha</code>仓库状态</p>
<p><strong>图属性</strong>： 对象可以被复制。以为址不同仓库间可以共享对象。</p>
<p><strong>图属性</strong>：一个仓库可以存储远程分支的引用，例如 <code>alpha/.git/refs/remotes/bravo/master</code> 。意味着，仓库可以在本地记录远程分支的状态。如果远程分支没有改变，这个状态就一直是正确的。</p>
<h3 id="合并分支-FETCH-HEAD"><a href="#合并分支-FETCH-HEAD" class="headerlink" title="合并分支 FETCH_HEAD"></a>合并分支 FETCH_HEAD</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git merge FETCH_HEAD</span><br><span class="line">          Updating d14c7d2..94cd04d</span><br><span class="line">          Fast-forward</span><br></pre></td></tr></table></figure>

<p>用户合并了分支<code>FETCH_HEAD</code>，这个分支也是一个指向某个提交的一个引用，被解析为指向 <code>12</code> 这个提交的一个引用。</p>
<p>合并前，<code>HEAD</code> 指向此次被合并的引用,  <code>11</code> 这个提交。 完成 <code>fast-forward</code> 合并后， <code>HEAD   </code>指向提交 <code>12</code>。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/e8af2aaf-ab84-4c4d-bb1a-1934a956f7af.png" alt="`alpha` after `FETCH_HEAD` merged"></p>
<p><code>alpha</code>仓库合并<code>FETCH_HEAD</code>后的状态</p>
<h3 id="拉取远程仓库"><a href="#拉取远程仓库" class="headerlink" title="拉取远程仓库"></a>拉取远程仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git pull bravo master</span><br><span class="line">          Already up-to-date.</span><br></pre></td></tr></table></figure>

<p>拉取远程仓库 <code>bravo</code> 的 <code>master</code> 分支到本地仓库 <code>alpha</code>。<code>pull</code> 操作是 “获取然后合并<code>FETCH_HEAD</code> “ 这两个命令的一个快捷方式。执行了这个命令后，反馈 <code>Already up-to-date</code>, 说明本地和远程内容一样。</p>
<h3 id="克隆一个仓库"><a href="#克隆一个仓库" class="headerlink" title="克隆一个仓库"></a>克隆一个仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">cd</span> ..</span><br><span class="line">      ~ $ git <span class="built_in">clone</span> alpha charlie</span><br><span class="line">          Cloning into <span class="string">&#x27;charlie&#x27;</span></span><br></pre></td></tr></table></figure>

<p>切换到 <code>alpha</code> 的上级目录，克隆仓库<code>alpha</code> 到目录 <code>charlie</code>，这个操作的结果，如同通过复制到到<code>bravo</code>仓库。</p>
<p>克隆仓库做的事情包括：创建新目录<code>charlie</code>; 在目录<code>charlie</code>下初始化仓库；将 <code>alpha</code> 作为远程仓库的 <code>origin</code>分支； 获取 <code>origin</code> 分支到本地；合并分支 <code>FETCH_HEAD</code>。</p>
<h3 id="推送本地分支到远程仓库"><a href="#推送本地分支到远程仓库" class="headerlink" title="推送本地分支到远程仓库"></a>推送本地分支到远程仓库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">      ~ $ <span class="built_in">cd</span> alpha</span><br><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;13&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;13&#x27;</span></span><br><span class="line">          [master 3238468] 13</span><br></pre></td></tr></table></figure>

<p>切换回 <code>alpha</code>仓库， 覆写文件 <code>data/number.txt</code> 为 <code>13</code> ，将改动提交到<code>alpha</code>仓库的分支 <code>master</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git remote add charlie ../charlie</span><br></pre></td></tr></table></figure>

<p>将本地目录<code>charlie</code> 作为本地仓库的<code>alpha</code> 的一个远程仓库。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git push charlie master</span><br><span class="line">          Writing objects: 100%</span><br><span class="line">          remote error: refusing to update checked out</span><br><span class="line">          branch: refs/heads/master because it will make</span><br><span class="line">          the index and work tree inconsistent</span><br></pre></td></tr></table></figure>

<p>推送本地仓库的<code>master</code> 分支到远程仓库 <code>charlie</code>。</p>
<p><code>13</code> 这个提交所需要的所有对象，被复制到到远程仓库<code>charlie</code>中。</p>
<p>至此，推送操作完成。和之前一样，如果操作出错，Git 会提示出错内容。例如，Git 会拒绝推送到一个在远程切出的分支。听起来是不是很有道理 ？由于一次推送操作会更新远程索引和 <code>HEAD</code>的指向，如果这个时候有人正在编辑远程副本的时候，就会导致冲突，出现不一致。</p>
<p>现在，可以创建一个新分支，合并 <code>13</code>这个内容到新分支 ，推送到远程仓库 <code>charlie</code>。但是，希望达到的是可以推送任何想推送的内容到仓库，希望又有一个可以推送和拉取到中心仓库，但是没人能直接推送到此中心仓库。有点像 GitHub 远程操作，最后的解决方案就是，裸库。</p>
<h3 id="克隆一个裸库"><a href="#克隆一个裸库" class="headerlink" title="克隆一个裸库"></a>克隆一个裸库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">cd</span> ..</span><br><span class="line">      ~ $ git <span class="built_in">clone</span> alpha delta --bare</span><br><span class="line">          Cloning into bare repository <span class="string">&#x27;delta&#x27;</span></span><br></pre></td></tr></table></figure>

<p>切换到 <code>alpha</code>上级目录，将裸库到目录 <code>delta</code> 。这个克隆有两点不同。一是<code>config</code>文件表明这是一个裸库；二是，通常位于 <code>.git</code>目录下的文件被现在存放在仓库的根目录下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">delta</span><br><span class="line">├── HEAD</span><br><span class="line">├── config</span><br><span class="line">├── objects</span><br><span class="line">└── refs</span><br></pre></td></tr></table></figure>

<p><img src="https://dn-coding-net-production-pp.qbox.me/c67037dc-7598-4eb7-b2f2-0d2ce01652bf.png" alt="`alpha` and `delta` graphs after `alpha` cloned to `delta`"></p>
<p>克隆<code>alpha</code> 到 <code>delta</code>后的仓库图</p>
<h3 id="推送分支到裸库"><a href="#推送分支到裸库" class="headerlink" title="推送分支到裸库"></a>推送分支到裸库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">      ~ $ <span class="built_in">cd</span> alpha</span><br><span class="line">~/alpha $ git remote add delta ../delta</span><br></pre></td></tr></table></figure>

<p>切换到 <code>alpha</code>目录。使用 <code>../delta</code> 目录 创建远程仓库<code>delta</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ <span class="built_in">printf</span> <span class="string">&#x27;14&#x27;</span> &gt; data/number.txt</span><br><span class="line">~/alpha $ git add data/number.txt</span><br><span class="line">~/alpha $ git commit -m <span class="string">&#x27;14&#x27;</span></span><br><span class="line">          [master cb51da8] 14</span><br></pre></td></tr></table></figure>

<p> 覆写文件 <code>data/number.txt</code> 为 <code>14</code> ，将改动提交到<code>alpha</code>仓库的分支 <code>master</code>。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/237349c4-8460-479d-b97b-c56e68c8dcb8.png" alt="`14` commit on `alpha`"></p>
<p><code>alpha</code> 仓库中的<code>14</code> 提交 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">~/alpha $ git push delta master</span><br><span class="line">          Writing objects: 100%</span><br><span class="line">          To ../delta</span><br><span class="line">            3238468..cb51da8 master -&gt; master</span><br></pre></td></tr></table></figure>

<p>推送<code>master</code>到仓库<code>delat</code>。推送过程包含三步：</p>
<p>第一步，<code>14</code>提交需要的所有对象，从<code>alpha/.git/objects/</code>目录，复制到目录<code>delta/objects/</code>。</p>
<p>第二步，更新文件<code>delta/refs/heads/master</code>内容，指向提交 <code>14</code>。</p>
<p>第三步，更新文件<code>alpha/.git/refs/remotes/delta/master</code>内容，指向提交 <code>14</code>。本地仓库<code>alpha</code>就有了远程仓库<code>delta</code>的一份最新状态记录。</p>
<p><img src="https://dn-coding-net-production-pp.qbox.me/546452c9-b324-46d5-a873-134fb5636a5b.png" alt="`14` commit pushed from `alpha` to `delta`"></p>
<p>推送<code>alpha</code>仓库到提交<code>14</code>到仓库<code>delta</code></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>Git 是在基于图的思想上构建的，几乎所有的 Git 命令都在维护这个图。想要深入理解 Git，就需要把精力集中在这个图的属性上，而不是在 Git 操作流程 或者 Git 命令。</p>
<p>想要更多的理解 Git，就去详细剖析 <code>.git</code> 目录，看里面都有些什么文件。通过改变文件内容，观察里面这些文件的变化。手动创建提交，看看可以把这个仓库搞什么鬼样子，然后尝试修复这些问题。</p>
<ol>
<li>通过这个案例，hash 值比原始文件内容要长。但是，所有文件的内容比 hash 值要长，这样的效果就是，表达的意思比原始文件要更加简洁明了。</li>
<li>有可能会出现两个不同的文件内容的 hash 值一样，但是，这个 <a target="_blank" rel="noopener" href="http://crypto.stackexchange.com/a/2584">机率很小</a>.。</li>
<li><code>git prune</code>会删除一个引用不能获取的所有对象。如果使用此命令，可能导致文件内容丢失。</li>
<li><code>git stash</code>会在一个安全的地方存储<code>HEAD</code>与当前工作区的差异。因此稍后可以恢复工作区。</li>
<li><code>rebase</code>可以对历史命令进行操作，达到新增，修改，删除提交的目的。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/20/%E8%BD%AC%E8%BD%BD-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BA-Git/" data-id="cl0xrrubb001lc4ty8rnfhvct" data-title="[转载]深入浅出 Git" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-利用GitLab搭建私有代码库" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/19/%E5%88%A9%E7%94%A8GitLab%E6%90%AD%E5%BB%BA%E7%A7%81%E6%9C%89%E4%BB%A3%E7%A0%81%E5%BA%93/" class="article-date">
  <time class="dt-published" datetime="2017-04-19T07:44:28.000Z" itemprop="datePublished">2017-04-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/19/%E5%88%A9%E7%94%A8GitLab%E6%90%AD%E5%BB%BA%E7%A7%81%E6%9C%89%E4%BB%A3%E7%A0%81%E5%BA%93/">利用GitLab搭建私有代码库</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="GitLab-简介"><a href="#GitLab-简介" class="headerlink" title="GitLab 简介"></a>GitLab 简介</h2><p>GitLab 是利用 Ruby On Rails 一个开源的版本管理系统，实现一个自托管的 Git 项目仓库，可通过 Web 界面进行访问公开的或者私人项目。它拥有与 GitHub 类似的功能，能够浏览源代码，管理缺陷和注释。可以管理团队对仓库的访问，它非常易于浏览提交过的版本并提供一个文件历史库。团队成员可以利用内置的简单聊天程序( Wall )进行交流。它还提供一个代码片段收集功能可以轻松实现代码复用，便于日后有需要的时候进行查找。</p>
<!---more--->

<p>GitHub 它是一个开源的社区, 如果你想把你们公司的项目放在上面就得交钱, 如果不交钱就得开源, 而 GitLab 是一个本地的项目管理仓库, 既然是本地那么想怎么玩就怎么玩儿</p>
<p><strong>优点</strong></p>
<ul>
<li>社区版基于 MIT License 开源完全免费</li>
<li>无用户，协作和仓库限制</li>
<li>保护项目源码安全</li>
<li>管理仓库，用户与访问权限</li>
</ul>
<h2 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境"></a>搭建环境</h2><ul>
<li>服务器：微软Azure主机</li>
<li>操作系统：Ubuntu 16.04 X64</li>
<li>软件包：LNMP组件</li>
</ul>
<h2 id="安装GitLab"><a href="#安装GitLab" class="headerlink" title="安装GitLab"></a>安装GitLab</h2><h3 id="选择版本"><a href="#选择版本" class="headerlink" title="选择版本"></a>选择版本</h3><p>GitLab分为社区版（GitLab Community Edition）和企业版（GitLab Enterprise Edition）。社区版免费，企业版收费，但是功能比社区版多。根据目前的需求，选择安装社区版（GitLab-CE）。</p>
<h3 id="安装配置依赖项"><a href="#安装配置依赖项" class="headerlink" title="安装配置依赖项"></a>安装配置依赖项</h3><p>如想使用Postfix来发送邮件,在安装期间请选择’Internet Site’. 您也可以用sendmai或者 配置SMTP服务 并 使用SMTP发送邮件.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install curl openssh-server ca-certificates postfix</span><br></pre></td></tr></table></figure>

<h3 id="添加GitLab仓库，并安装到服务器上"><a href="#添加GitLab仓库，并安装到服务器上" class="headerlink" title="添加GitLab仓库，并安装到服务器上"></a>添加GitLab仓库，并安装到服务器上</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sS http://packages.gitlab.cc/install/gitlab-ce/script.deb.sh | sudo bash</span><br><span class="line">apt install gitlab-ce</span><br></pre></td></tr></table></figure>

<h3 id="启动GitLab"><a href="#启动GitLab" class="headerlink" title="启动GitLab"></a>启动GitLab</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>

<h3 id="使用浏览器访问GitLab"><a href="#使用浏览器访问GitLab" class="headerlink" title="使用浏览器访问GitLab"></a>使用浏览器访问GitLab</h3><p>首次访问GitLab,系统会让你重新设置管理员的密码,设置成功后会返回登录界面.<br>默认的管理员账号是root,如果你想更改默认管理员账号,请输入上面设置的新密码登录系统后修改帐号名.</p>
<h2 id="未完待续。。。。。。"><a href="#未完待续。。。。。。" class="headerlink" title="未完待续。。。。。。"></a>未完待续。。。。。。</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/19/%E5%88%A9%E7%94%A8GitLab%E6%90%AD%E5%BB%BA%E7%A7%81%E6%9C%89%E4%BB%A3%E7%A0%81%E5%BA%93/" data-id="cl0xrrub8001ec4tyh77q5qsz" data-title="利用GitLab搭建私有代码库" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-LEDE编译教程" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/16/LEDE%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2017-04-16T10:20:01.000Z" itemprop="datePublished">2017-04-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/16/LEDE%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/">LEDE编译教程</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>LEDE-project是 OpenWrt 的一个分支，是为了解决OpenWrt遗留的一些问题而设立，拥有更多的支持。</p>
<!---more--->

<h2 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h2><h3 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h3><p>LEDE-project开发环境及依赖：</p>
<ul>
<li>系统：ubuntu 16.04 x64</li>
<li>依赖：build-essential subversion git-core libncurses5-dev zlib1g-dev gawk flex quilt libssl-dev xsltproc libxml-parser-perl mercurial bzr ecj cvs unzip</li>
</ul>
<h3 id="安装依赖"><a href="#安装依赖" class="headerlink" title="安装依赖"></a>安装依赖</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt upgrade -y</span><br><span class="line"></span><br><span class="line">apt install build-essential subversion git-core libncurses5-dev zlib1g-dev gawk flex quilt libssl-dev xsltproc libxml-parser-perl mercurial bzr ecj cvs unzip</span><br></pre></td></tr></table></figure>

<h3 id="下载源码"><a href="#下载源码" class="headerlink" title="下载源码"></a>下载源码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/lede-project/source.git LEDE-project</span><br><span class="line"></span><br><span class="line">cd LEDE-project</span><br><span class="line"></span><br><span class="line">./scripts/feeds update -a</span><br><span class="line"></span><br><span class="line">./scripts/feeds install -a</span><br></pre></td></tr></table></figure>

<h2 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h2><h3 id="编辑固件设置"><a href="#编辑固件设置" class="headerlink" title="编辑固件设置"></a>编辑固件设置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make menuconfig</span><br></pre></td></tr></table></figure>

<p>执行后出现配置界面，根据需要选择自己的配置选项。</p>
<p>备注：记得勾选<code>SDK</code></p>
<h3 id="开始编译"><a href="#开始编译" class="headerlink" title="开始编译"></a>开始编译</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make V=s</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>编译时间较长；</li>
<li>编译过程中，需要爬墙下载相关软件包；</li>
</ul>
<h3 id="完成编译"><a href="#完成编译" class="headerlink" title="完成编译"></a>完成编译</h3><p>编译完成后，便可以在<code>/bin/$target</code>目录下找到刷机的固件和SDK.这里最好做一个备份，方便以后使用。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a target="_blank" rel="noopener" href="https://github.com/lede-project/source">lede-project</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/16/LEDE%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/" data-id="cl0xrruam000cc4tyht161fdd" data-title="LEDE编译教程" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LEDE/" rel="tag">LEDE</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BC%96%E8%AF%91/" rel="tag">编译</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-SSR-Panel-V3-Mod-搭建教程" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/16/SSR-Panel-V3-Mod-%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/" class="article-date">
  <time class="dt-published" datetime="2017-04-16T08:57:12.000Z" itemprop="datePublished">2017-04-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/16/SSR-Panel-V3-Mod-%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/">SSR-Panel V3 Mod 搭建教程</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>前端使用<a target="_blank" rel="noopener" href="https://github.com/esdeathlove/ss-panel-v3-mod">赵大的魔改版</a><br>后端也使用<a target="_blank" rel="noopener" href="https://github.com/esdeathlove/shadowsocks">赵大的魔改版</a><br>演示环境 : Azure 1.75 G RAM机子 Ubuntu 16.04 x64</p>
<!---more--->

<h2 id="安装前段"><a href="#安装前段" class="headerlink" title="安装前段"></a>安装前段</h2><h3 id="安装LNMP"><a href="#安装LNMP" class="headerlink" title="安装LNMP"></a>安装LNMP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">screen -S lnmp</span><br><span class="line">2G以上内存</span><br><span class="line">wget http://soft.vpser.net/lnmp/lnmp1.3-full.tar.gz &amp;&amp; tar xvzf lnmp1.3-full.tar.gz</span><br><span class="line">cd lnmp1.3-full &amp;&amp; ./install.sh</span><br><span class="line">1G以下内存</span><br><span class="line">wget http://soft.vpser.net/lnmp/lnmp1.2-full.tar.gz &amp;&amp; tar xvzf lnmp1.2-full.tar.gz</span><br><span class="line">cd lnmp1.2-full &amp;&amp; ./install.sh</span><br></pre></td></tr></table></figure>
<p>安装过程要求输入<code>MySQL</code>密码, 选择<code>MySQL</code>版本<code>&gt;=5.5</code>, <code>PHP</code>版本<code>&gt;5.6</code>.<br>我选择的是<code>MariaDB 10</code>, <code>PHP 7.0</code>.<br>安装大概需要半小时, 如果中途 ssh 断线, 输入<code>screen -r lnmp</code></p>
<h3 id="设置虚拟机"><a href="#设置虚拟机" class="headerlink" title="设置虚拟机"></a>设置虚拟机</h3><p><code>lnmp vhost add</code><br>要求输入你的域名, 然后其余项都选 <code>no</code><br>接着修改下 <code>nginx</code><br>编辑 <code>/usr/local/nginx/conf/vhost/你的域名.conf</code><br>然后添加下面这一段到 <code>server</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / </span><br><span class="line">	&#123;</span><br><span class="line">		try_files $uri $uri/ /index.php$is_args$args;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>修改 root 那一行为<br><code>root /home/wwwroot/你的域名/public;</code></p>
<h3 id="下载-sspanel-代码"><a href="#下载-sspanel-代码" class="headerlink" title="下载 sspanel 代码"></a>下载 sspanel 代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd /home/wwwroot/你的域名</span><br><span class="line">apt-get install git -y</span><br><span class="line">git clone -b master https://github.com/esdeathlove/ss-panel-v3-mod.git tmp &amp;&amp; mv tmp/.git . &amp;&amp; rm -rf tmp &amp;&amp; git reset --hard</span><br><span class="line">chown -R root:root *</span><br><span class="line">chmod -R 755 *</span><br><span class="line">chown -R www:www storage</span><br><span class="line">chattr -i .user.ini</span><br><span class="line">mv .user.ini public</span><br><span class="line">cd public</span><br><span class="line">chattr +i .user.ini</span><br><span class="line">lnmp nginx restart</span><br></pre></td></tr></table></figure>

<h3 id="配置数据库"><a href="#配置数据库" class="headerlink" title="配置数据库"></a>配置数据库</h3><p>浏览器打开 <code>http://你的vps ip/phpmyadmin</code><br>用户 : <code>root</code><br>密码 :安装 <code>lnmp</code> 时设置的<br>需要创建一个数据库和一个访问这个数据库的用户<br>点击 用户 -&gt; 新建 -&gt; 添加用户</p>
<ul>
<li>登录信息 :<ul>
<li>Username 选择 使用文本域 , 填写你的用户名 如 <code>sspanel</code></li>
<li>Host 选择任意主机 <code>%</code></li>
<li>密码 选择使用文本域 填写密码</li>
</ul>
</li>
<li>用户数据库 :<ul>
<li>勾选 创建与用户同名的数据库并授予所有权限<br>接着按执行 选择刚刚新建的数据库 <code>sspanel</code> 导入程序目录下的 <code>glzjin_all.sql</code></li>
</ul>
</li>
</ul>
<h3 id="配置-sspanel"><a href="#配置-sspanel" class="headerlink" title="配置 sspanel"></a>配置 sspanel</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/wwwroot/你的域名</span><br><span class="line">cp config/.config.php.example config/.config.php</span><br><span class="line"># 编辑以下文件 建议使用 FTP 下载到本地修改</span><br><span class="line">vi config/.config.php</span><br></pre></td></tr></table></figure>
<p>由于配置太多 这里只说重点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">$System_Config[&#x27;key&#x27;] = &#x27;&#x27;;			//修改此key为随机字符串确保网站安全</span><br><span class="line">$System_Config[&#x27;appName&#x27;] = &#x27;&#x27;;             //站点名称</span><br><span class="line">$System_Config[&#x27;baseUrl&#x27;] = &#x27;https://zhaojin97.cn&#x27;;            // 站点地址</span><br><span class="line">$System_Config[&#x27;timeZone&#x27;] = &#x27;PRC&#x27;;        // RPC 天朝时间  UTC 格林时间</span><br><span class="line">$System_Config[&#x27;pwdMethod&#x27;] = &#x27;sha256&#x27;;       // 密码加密   可选 md5,sha256</span><br><span class="line">$System_Config[&#x27;salt&#x27;] = &#x27;&#x27;;               // 密码加密用，从旧版升级请留空</span><br><span class="line">$System_Config[&#x27;authDriver&#x27;] = &#x27;cookie&#x27;;   // 登录验证存储方式,推荐使用Redis   可选: cookie,redis</span><br><span class="line"></span><br><span class="line">$System_Config[&#x27;mailDriver&#x27;] = &#x27;mailgun&#x27;;   // 邮件 可选 mailgun or smtp 需要支持qq邮箱的选 smtp</span><br><span class="line"></span><br><span class="line">$System_Config[&#x27;checkinMin&#x27;] = &#x27;100&#x27;;       // 签到最少流量 单位MB</span><br><span class="line">$System_Config[&#x27;checkinMax&#x27;] = &#x27;500&#x27;;       // 签到最多流量</span><br><span class="line">$System_Config[&#x27;defaultTraffic&#x27;] = &#x27;100&#x27;;      // 用户初始流量 单位GB</span><br><span class="line">$System_Config[&#x27;inviteNum&#x27;] = &#x27;0&#x27;;			// 注册后获得的邀请码数量</span><br><span class="line"></span><br><span class="line"># database 数据库配置</span><br><span class="line">$System_Config[&#x27;db_driver&#x27;] = &#x27;mysql&#x27;;</span><br><span class="line">$System_Config[&#x27;db_host&#x27;] = &#x27;localhost&#x27;;		// 数据库地址</span><br><span class="line">$System_Config[&#x27;db_database&#x27;] = &#x27;&#x27;;				// 数据库名称 sspanel</span><br><span class="line">$System_Config[&#x27;db_username&#x27;] = &#x27;&#x27;;				// 数据库用户 sspanel</span><br><span class="line">$System_Config[&#x27;db_password&#x27;] = &#x27;&#x27;;				// sspanel用户的密码</span><br><span class="line">$System_Config[&#x27;db_charset&#x27;] = &#x27;utf8&#x27;;</span><br><span class="line">$System_Config[&#x27;db_collation&#x27;] = &#x27;utf8_general_ci&#x27;;</span><br><span class="line">$System_Config[&#x27;db_prefix&#x27;] = &#x27;&#x27;;</span><br><span class="line"></span><br><span class="line"># redis</span><br><span class="line">$System_Config[&#x27;redis_scheme&#x27;] = &#x27;tcp&#x27;;			// 登录验证存储方式选了 redis 的话需要配置</span><br><span class="line">$System_Config[&#x27;redis_host&#x27;] = &#x27;127.0.0.1&#x27;;</span><br><span class="line">$System_Config[&#x27;redis_port&#x27;] = &#x27;6379&#x27;;</span><br><span class="line">$System_Config[&#x27;redis_database&#x27;] = &#x27;0&#x27;;</span><br><span class="line">$System_Config[&#x27;redis_password&#x27;]=&quot;&quot;;</span><br><span class="line"></span><br><span class="line"># smtp</span><br><span class="line">$System_Config[&#x27;smtp_host&#x27;] = &#x27;&#x27;;				// 例如 smtp.qq.com</span><br><span class="line">$System_Config[&#x27;smtp_username&#x27;] = &#x27;&#x27;;</span><br><span class="line">$System_Config[&#x27;smtp_port&#x27;] = &#x27;25&#x27;;</span><br><span class="line">$System_Config[&#x27;smtp_name&#x27;] = &#x27;&#x27;;</span><br><span class="line">$System_Config[&#x27;smtp_sender&#x27;] = &#x27;&#x27;;</span><br><span class="line">$System_Config[&#x27;smtp_passsword&#x27;] = &#x27;&#x27;;</span><br><span class="line">$System_Config[&#x27;smtp_ssl&#x27;] = &#x27;false&#x27;;</span><br><span class="line"></span><br><span class="line">#功能开关  需要用到的才开 建议先别动</span><br><span class="line">$System_Config[&#x27;enable_wecenter&#x27;]=&#x27;false&#x27;;</span><br><span class="line">$System_Config[&#x27;enable_radius&#x27;]=&#x27;false&#x27;;		// 配置了 radius 的话就开</span><br><span class="line">$System_Config[&#x27;enable_cloudxns&#x27;]=&#x27;false&#x27;;</span><br><span class="line">$System_Config[&#x27;enable_duoshuo&#x27;]=&#x27;false&#x27;;</span><br><span class="line">$System_Config[&#x27;enable_rss&#x27;]=&#x27;true&#x27;;</span><br><span class="line">$System_Config[&#x27;enable_paymentwall&#x27;]=&#x27;false&#x27;;</span><br><span class="line"></span><br><span class="line">#Radius数据库设置</span><br><span class="line">$System_Config[&#x27;radius_db_host&#x27;]=&#x27;&#x27;;		// 跟 上面 database 数据库配置差不多 换成radius即可</span><br><span class="line">$System_Config[&#x27;radius_db_database&#x27;]=&#x27;&#x27;;</span><br><span class="line">$System_Config[&#x27;radius_db_user&#x27;]=&#x27;&#x27;;</span><br><span class="line">$System_Config[&#x27;radius_db_password&#x27;]=&#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">#Radius连接密钥</span><br><span class="line">$System_Config[&#x27;radius_secret&#x27;]=&#x27;&#x27;;			// 这个重要 必须设</span><br><span class="line"></span><br><span class="line">#端口池</span><br><span class="line">$System_Config[&#x27;min_port&#x27;]=&#x27;10000&#x27;;			// SSR 分配端口号范围</span><br><span class="line">$System_Config[&#x27;max_port&#x27;]=&#x27;65535&#x27;;</span><br><span class="line"></span><br><span class="line">#两种方式相对于ss端口的偏移</span><br><span class="line">$System_Config[&#x27;pacp_offset&#x27;]=&#x27;-20000&#x27;;		// PAC+ 和 PAC++ 用到</span><br><span class="line">$System_Config[&#x27;pacpp_offset&#x27;]=&#x27;-20000&#x27;;</span><br><span class="line"></span><br><span class="line">#测速周期/h</span><br><span class="line">$System_Config[&#x27;Speedtest_duration&#x27;]=&#x27;6&#x27;;	// 对应后端 SSR 的 userapiconfig.py 里的 SPEEDTEST</span><br><span class="line"></span><br><span class="line">#随机分组，注册时随机分配到的分组，多个分组请用英文半角逗号分隔。</span><br><span class="line">$System_Config[&#x27;ramdom_group&#x27;]=&#x27;0&#x27;;			// 组别用于区分用户组 对应组只能访问对应组和0组的服务器 明白后再修改 </span><br><span class="line"></span><br><span class="line">#充值返利百分比</span><br><span class="line">$System_Config[&#x27;code_payback&#x27;]=&#x27;20&#x27;;		// 用户充值后 给邀请他注册的人返利多少%</span><br><span class="line"></span><br><span class="line">#注册时的流量重置日以及需要重置的流量,0不重置</span><br><span class="line">$System_Config[&#x27;reg_auto_reset_day&#x27;]=&#x27;0&#x27;;</span><br><span class="line">$System_Config[&#x27;reg_auto_reset_bandwidth&#x27;]=&#x27;100&#x27;;	// 单位G</span><br></pre></td></tr></table></figure>
<p>以上为 <code>config</code> 部分配置 完成后保存并上传到原目录下<br>切换到 <code>ssh</code> 窗口, 在你的网站目录下执行以下命令创建管理员<br><code>php xcat createAdmin</code><br>按照提示, 输入管理员邮箱密码等信息, 然后执行以下命令同步用户<br><code>php xcat syncusers</code><br>此时管理员创建完成<br>接下来需要对服务器进行计划任务的设置,执行 <code>crontab -e</code> 命令, 添加以下五段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">30 22 * * * php /home/wwwroot/站点文件夹/xcat sendDiaryMail</span><br><span class="line">*/1 * * * * php /home/wwwroot/站点文件夹/xcat synclogin</span><br><span class="line">*/1 * * * * php /home/wwwroot/站点文件夹/xcat syncvpn</span><br><span class="line">0 0 * * * php /home/wwwroot/站点文件夹/xcat dailyjob</span><br><span class="line">*/1 * * * * php /home/wwwroot/站点文件夹/xcat checkjob</span><br><span class="line">*/1 * * * * php /home/wwwroot/站点文件夹/xcat syncnas</span><br></pre></td></tr></table></figure>
<p>重启Crontab<br><code>/etc/init.d/cron restart</code></p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p>检查时间是否为天朝时间<br>如果<code>VPS</code>默认是非中国时区的话, 如下命令可以用来更改为中国时区<br><code>cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</code><br>检查防火墙是否屏蔽数据库端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 允许本机访问</span><br><span class="line">iptables -A INPUT -s 127.0.0.1/32 -p tcp -m tcp --dport 3306 -j ACCEPT</span><br><span class="line"># 允许节点访问</span><br><span class="line">iptables -A INPUT -s 节点IP -p tcp -m tcp --dport 3306 -j ACCEPT</span><br><span class="line"># 允许所有IP访问</span><br><span class="line">iptables -A INPUT -p tcp -m tcp --dport 3306 -j ACCEPT</span><br></pre></td></tr></table></figure>
<p>查看防火墙规则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查看已添加的iptables规则</span><br><span class="line">iptables -L -n --line-numbers</span><br><span class="line">删除已添加的iptables规则</span><br><span class="line">iptables -D INPUT line-numbers</span><br></pre></td></tr></table></figure>
<p>规则保存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Ubuntu</span><br><span class="line">iptables-save &gt; /etc/iptables.rules</span><br><span class="line"># CentOS</span><br><span class="line">service iptables save</span><br></pre></td></tr></table></figure>

<h2 id="安装后端"><a href="#安装后端" class="headerlink" title="安装后端"></a>安装后端</h2><h3 id="安装-libsodium"><a href="#安装-libsodium" class="headerlink" title="安装 libsodium"></a>安装 libsodium</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get install build-essential wget -y</span><br><span class="line">wget https://github.com/jedisct1/libsodium/releases/download/1.0.10/libsodium-1.0.10.tar.gz</span><br><span class="line">tar xf libsodium-1.0.10.tar.gz &amp;&amp; cd libsodium-1.0.10</span><br><span class="line">./configure &amp;&amp; make -j2 &amp;&amp; make install</span><br><span class="line">ldconfig</span><br></pre></td></tr></table></figure>

<h3 id="安装SSR"><a href="#安装SSR" class="headerlink" title="安装SSR"></a>安装SSR</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">apt-get install python-pip git -y</span><br><span class="line">pip install cymysql</span><br><span class="line">cd ..</span><br><span class="line">git clone -b manyuser https://github.com/glzjin/shadowsocks.git</span><br><span class="line">cd shadowsocks</span><br><span class="line">chmod +x *.sh</span><br><span class="line"># 配置程序</span><br><span class="line">cp apiconfig.py userapiconfig.py</span><br><span class="line">cp config.json user-config.json</span><br><span class="line">vi userapiconfig.py</span><br></pre></td></tr></table></figure>
<p>然后主要编辑 <code>userapiconfig.py</code>, 来解释下里面各项配置的意思</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"># Config</span><br><span class="line">#节点ID 对应前端节点列表的ID</span><br><span class="line">NODE_ID = 1</span><br><span class="line"></span><br><span class="line">#自动化测速，为0不测试，此处以小时为单位，要和 ss-panel 设置的小时数一致</span><br><span class="line">SPEEDTEST = 6</span><br><span class="line"></span><br><span class="line">#云安全，自动上报与下载封禁IP，1为开启，0为关闭</span><br><span class="line">CLOUDSAFE = 1</span><br><span class="line"></span><br><span class="line">#自动封禁SS密码和加密方式错误的 IP，1为开启，0为关闭</span><br><span class="line">ANTISSATTACK = 0</span><br><span class="line"></span><br><span class="line">#是否接受上级下发的命令，如果你要用这个命令，请参考我之前写的东西，公钥放在目录下的 ssshell.asc</span><br><span class="line">AUTOEXEC = 1</span><br><span class="line"></span><br><span class="line">#是否以多线程模式运行，关闭这个限速就会无效。请优先测试 1 ，开启试试，能运行没。</span><br><span class="line">MULTI_THREAD = 0</span><br><span class="line"></span><br><span class="line">#多端口单用户设置，看重大更新说明。</span><br><span class="line">MU_SUFFIX = &#x27;zhaoj.in&#x27;</span><br><span class="line">#多端口单用户设置，看重大更新说明。</span><br><span class="line">MU_REGEX = &#x27;%5m%id.%suffix&#x27;</span><br><span class="line"></span><br><span class="line">#不明觉厉</span><br><span class="line">SERVER_PUB_ADDR = &#x27;127.0.0.1&#x27; # mujson_mgr need this to generate ssr link</span><br><span class="line">#此处不要修改</span><br><span class="line">API_INTERFACE = &#x27;glzjinmod&#x27; #mudbjson, sspanelv2, sspanelv3, sspanelv3ssr, muapiv2(not support)</span><br><span class="line">#mudb，不要管</span><br><span class="line">MUDB_FILE = &#x27;mudb.json&#x27;</span><br><span class="line"></span><br><span class="line"># Mysql 数据库连接信息</span><br><span class="line">MYSQL_HOST = &#x27;127.0.0.1&#x27;</span><br><span class="line">MYSQL_PORT = 3306</span><br><span class="line">MYSQL_USER = &#x27;ss&#x27;</span><br><span class="line">MYSQL_PASS = &#x27;ss&#x27;</span><br><span class="line">MYSQL_DB = &#x27;shadowsocks&#x27;</span><br><span class="line">MYSQL_UPDATE_TIME = 60</span><br><span class="line"></span><br><span class="line"># 是否启用SSL连接，0为关，1为开</span><br><span class="line">MYSQL_SSL_ENABLE = 0</span><br><span class="line"></span><br><span class="line"># 客户端证书目录，请看 https://github.com/glzjin/shadowsocks/wiki/Mysql-SSL%E9%85%8D%E7%BD%AE</span><br><span class="line">MYSQL_SSL_CERT = &#x27;/root/shadowsocks/client-cert.pem&#x27;</span><br><span class="line">MYSQL_SSL_KEY = &#x27;/root/shadowsocks/client-key.pem&#x27;</span><br><span class="line">MYSQL_SSL_CA = &#x27;/root/shadowsocks/ca.pem&#x27;</span><br><span class="line"></span><br><span class="line"># API，不用管</span><br><span class="line">API_HOST = &#x27;127.0.0.1&#x27;</span><br><span class="line">API_PORT = 80</span><br><span class="line">API_PATH = &#x27;/mu/v2/&#x27;</span><br><span class="line">API_TOKEN = &#x27;abcdef&#x27;</span><br><span class="line">API_UPDATE_TIME = 60</span><br><span class="line"></span><br><span class="line"># Manager 不用管</span><br><span class="line">MANAGE_PASS = &#x27;ss233333333&#x27;</span><br><span class="line"></span><br><span class="line">#if you want manage in other server you should set this value to global ip</span><br><span class="line">MANAGE_BIND_IP = &#x27;127.0.0.1&#x27;</span><br><span class="line"></span><br><span class="line">#make sure this port is idle</span><br><span class="line">MANAGE_PORT = 23333</span><br></pre></td></tr></table></figure>

<h3 id="运行SSR"><a href="#运行SSR" class="headerlink" title="运行SSR"></a>运行SSR</h3><p>运行的话, 有几种方式</p>
<ul>
<li><code>python server.py</code> 用于调错的</li>
<li><code>./run.sh</code> 无日志后台运行</li>
<li><code>./logrun.sh</code> 有日志后台运行</li>
<li><code>supervisord</code><br>这里说下 使用<code>Supervisor</code>守护进程启动<code>ssr</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">apt-get install supervisor -y</span><br><span class="line"></span><br><span class="line"># 写入配置</span><br><span class="line">vi /etc/supervisor/conf.d/ssr.conf</span><br><span class="line"></span><br><span class="line"># 写入以下内容</span><br><span class="line">[program:ssr]</span><br><span class="line">command=python /root/shadowsocks/server.py </span><br><span class="line">autorestart=true</span><br><span class="line">autostart=true</span><br><span class="line">user=root</span><br><span class="line"></span><br><span class="line"># 重启Supervisor服务。</span><br><span class="line">/etc/init.d/supervisor restart</span><br><span class="line"></span><br><span class="line"># 重启 ssr</span><br><span class="line">supervisorctl restart ssr</span><br><span class="line"></span><br><span class="line"># 查看Supervisor服务运行状态。</span><br><span class="line">supervisorctl status</span><br><span class="line"></span><br><span class="line"># 如果遇到问题，可以检查日志：</span><br><span class="line">supervisorctl tail -f ssr stderr</span><br><span class="line"></span><br><span class="line"># 如果使用supervisor进程守护，需要修改文件vi /etc/default/supervisor，添加一行：</span><br><span class="line">ulimit -n 1024000</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="转载"><a href="#转载" class="headerlink" title="转载"></a>转载</h2><p><a target="_blank" rel="noopener" href="https://imeiji.github.io/2017/01/09/%E6%90%AD%E5%BB%BA%20sspanel%20v3%20%E9%AD%94%E6%94%B9%E7%89%88%E8%AE%B0%E5%BD%95/">搭建 sspanel v3 魔改版记录</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/16/SSR-Panel-V3-Mod-%E6%90%AD%E5%BB%BA%E6%95%99%E7%A8%8B/" data-id="cl0xrruar000jc4tygdhy30sf" data-title="SSR-Panel V3 Mod 搭建教程" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SSR/" rel="tag">SSR</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VPS/" rel="tag">VPS</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-WDMyCloud插件开源" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2017/04/02/WDMyCloud%E6%8F%92%E4%BB%B6%E5%BC%80%E6%BA%90/" class="article-date">
  <time class="dt-published" datetime="2017-04-02T05:19:51.000Z" itemprop="datePublished">2017-04-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2017/04/02/WDMyCloud%E6%8F%92%E4%BB%B6%E5%BC%80%E6%BA%90/">WDMyCloud插件开源</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>开源地址：<a target="_blank" rel="noopener" href="https://github.com/Auska/mycloud-plugin">https://github.com/Auska/mycloud-plugin</a></p>
<p>插件使用教程：<a target="_blank" rel="noopener" href="http://www.nasyun.com/thread-27341-1-1.html">http://www.nasyun.com/thread-27341-1-1.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2017/04/02/WDMyCloud%E6%8F%92%E4%BB%B6%E5%BC%80%E6%BA%90/" data-id="cl0xrrub50014c4ty8mhf7c8j" data-title="WDMyCloud插件开源" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NAS/" rel="tag">NAS</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-钢铁雄心IV控制台命令" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/08/19/%E9%92%A2%E9%93%81%E9%9B%84%E5%BF%83IV%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/" class="article-date">
  <time class="dt-published" datetime="2016-08-19T09:27:05.000Z" itemprop="datePublished">2016-08-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/08/19/%E9%92%A2%E9%93%81%E9%9B%84%E5%BF%83IV%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/">钢铁雄心IV控制台命令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>按“~”键打开控制台，输入指令。</p>
        
          <p class="article-more-link">
            <a href="/2016/08/19/%E9%92%A2%E9%93%81%E9%9B%84%E5%BF%83IV%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2016/08/19/%E9%92%A2%E9%93%81%E9%9B%84%E5%BF%83IV%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%91%BD%E4%BB%A4/" data-id="cl0xrrubd001qc4tyf998e0dn" data-title="钢铁雄心IV控制台命令" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%B8%E6%88%8F/" rel="tag">游戏</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-WDMyCloud安装DSM固件操作说明" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2016/07/07/WDMyCloud%E5%AE%89%E8%A3%85DSM%E5%9B%BA%E4%BB%B6%E6%93%8D%E4%BD%9C%E8%AF%B4%E6%98%8E/" class="article-date">
  <time class="dt-published" datetime="2016-07-07T05:19:51.000Z" itemprop="datePublished">2016-07-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2016/07/07/WDMyCloud%E5%AE%89%E8%A3%85DSM%E5%9B%BA%E4%BB%B6%E6%93%8D%E4%BD%9C%E8%AF%B4%E6%98%8E/">WDMyCloud安装DSM固件操作说明</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="WDMyCloud安装DSM固件操作说明"><a href="#WDMyCloud安装DSM固件操作说明" class="headerlink" title="WDMyCloud安装DSM固件操作说明"></a>WDMyCloud安装DSM固件操作说明</h2><ul>
<li>该教程仅适用<code>WDMyCloud Gen2</code>版本硬件，为什么呢？我只有<code>Gen2</code>版本的设备。</li>
</ul>
        
          <p class="article-more-link">
            <a href="/2016/07/07/WDMyCloud%E5%AE%89%E8%A3%85DSM%E5%9B%BA%E4%BB%B6%E6%93%8D%E4%BD%9C%E8%AF%B4%E6%98%8E/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://auska.github.io/2016/07/07/WDMyCloud%E5%AE%89%E8%A3%85DSM%E5%9B%BA%E4%BB%B6%E6%93%8D%E4%BD%9C%E8%AF%B4%E6%98%8E/" data-id="cl0xrrub50016c4ty5mfebsqm" data-title="WDMyCloud安装DSM固件操作说明" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NAS/" rel="tag">NAS</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bilibili/" rel="tag">Bilibili</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cross/" rel="tag">Cross</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DSM/" rel="tag">DSM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Go/" rel="tag">Go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gogs/" rel="tag">Gogs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LEDE/" rel="tag">LEDE</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NAS/" rel="tag">NAS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SS/" rel="tag">SS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSR/" rel="tag">SSR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VPS/" rel="tag">VPS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WDMyCloud/" rel="tag">WDMyCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/h5ai/" rel="tag">h5ai</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E5%AF%86/" rel="tag">加密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8E%8B%E5%88%B6/" rel="tag">压制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%82%E6%9C%BA/" rel="tag">挂机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%99%E7%A8%8B/" rel="tag">教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B8%E6%88%8F/" rel="tag">游戏</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91/" rel="tag">编译</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%A3%E5%AF%86/" rel="tag">解密</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B5%84%E6%BA%90/" rel="tag">资源</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Bilibili/" style="font-size: 10px;">Bilibili</a> <a href="/tags/Cross/" style="font-size: 10px;">Cross</a> <a href="/tags/DSM/" style="font-size: 13.33px;">DSM</a> <a href="/tags/Go/" style="font-size: 10px;">Go</a> <a href="/tags/Gogs/" style="font-size: 10px;">Gogs</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/LEDE/" style="font-size: 10px;">LEDE</a> <a href="/tags/NAS/" style="font-size: 20px;">NAS</a> <a href="/tags/SS/" style="font-size: 10px;">SS</a> <a href="/tags/SSR/" style="font-size: 10px;">SSR</a> <a href="/tags/VPS/" style="font-size: 15px;">VPS</a> <a href="/tags/WDMyCloud/" style="font-size: 16.67px;">WDMyCloud</a> <a href="/tags/git/" style="font-size: 11.67px;">git</a> <a href="/tags/gitlab/" style="font-size: 10px;">gitlab</a> <a href="/tags/h5ai/" style="font-size: 10px;">h5ai</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 10px;">加密</a> <a href="/tags/%E5%8E%8B%E5%88%B6/" style="font-size: 10px;">压制</a> <a href="/tags/%E6%8C%82%E6%9C%BA/" style="font-size: 10px;">挂机</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 18.33px;">教程</a> <a href="/tags/%E6%B8%B8%E6%88%8F/" style="font-size: 10px;">游戏</a> <a href="/tags/%E7%BC%96%E8%AF%91/" style="font-size: 11.67px;">编译</a> <a href="/tags/%E8%A7%A3%E5%AF%86/" style="font-size: 10px;">解密</a> <a href="/tags/%E8%B5%84%E6%BA%90/" style="font-size: 11.67px;">资源</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/06/02/%E7%BE%A4%E6%99%96%E5%AE%89%E8%A3%85-qBittorrent-%E5%A5%97%E4%BB%B6/">群晖安装 qBittorrent 套件</a>
          </li>
        
          <li>
            <a href="/2019/02/01/mergerfs%20%E5%90%88%E5%B9%B6%E5%A4%9A%E5%9D%97%E7%A1%AC%E7%9B%98%E7%9A%84%E5%89%A9%E4%BD%99%E7%A9%BA%E9%97%B4/">（转载）mergerfs 合并多块硬盘的剩余空间</a>
          </li>
        
          <li>
            <a href="/2019/02/01/%E7%9B%AE%E5%BD%95%E7%BA%A7%E5%88%AB%E7%9A%84%E5%86%97%E4%BD%99%E5%AD%98%E5%82%A8%EF%BC%9ASnapRAID/">（转载）目录级别的冗余存储：SnapRAID</a>
          </li>
        
          <li>
            <a href="/2018/09/11/Docker%20%E4%B8%AA%E4%BA%BA%E9%95%9C%E5%83%8F%E8%B5%84%E6%BA%90/">Docker 个人镜像资源</a>
          </li>
        
          <li>
            <a href="/2017/09/24/%E9%9D%99%E6%80%81%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E6%95%99%E7%A8%8B/">静态交叉编译教程</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 Auska<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>